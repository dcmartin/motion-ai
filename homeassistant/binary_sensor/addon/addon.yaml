###
# homeassistant/binary_sensor/motion/addon.yaml
###

- platform: template
  sensors:
    motion_addon_status:
      friendly_name: 'Status: Add-on'
      device_class: connectivity
      icon_template: >-
        {%- set e = states('sensor.motion_addon_status') -%}
        {%- if e|lower != 'unknown' and e|lower != 'unavailable' and e|lower != 'none' and e|lower != 'null' -%}
          {%- if e|lower == 'true' -%}
            {{- 'mdi:video-check' -}}
          {% else %}
            {{- 'mdi:video-outline' -}}
          {% endif %}
        {%- else -%}{{- 'mdi:video' -}}{%- endif -%}
      value_template: >-
        {% set e = states('sensor.motion_addon_status') %}
        {% if e|lower != 'unknown' and e|lower != 'unavailable' and e|lower != 'none' and e|lower != 'null' %}
          {% set a = states('sensor.motion_addon_status_ago') %}
          {% if a|lower != 'unknown' and a|lower != 'unavailable' and a|lower != 'none' and a|lower != 'null' %}
            {{- e|lower == 'true' and a|int(0) <= states('input_number.motion_addon_status_ago')|int(0) -}}
          {% else %}null{% endif %}
        {% else %}null{% endif %}

- platform: template
  sensors:
    motion_addon_installed:
      friendly_name: Add-on installed
      icon_template: >-
        {%- if is_state_attr('binary_sensor.motion_addon_update','addon','age_home') -%}
          {{- 'mdi:home-heart' -}}
        {%- elif is_state_attr('binary_sensor.motion_addon_update','addon','motion_classic') -%}
           {{- 'mdi:eye-plus' -}}
        {%- else -%}
           {{- 'mdi:cancel' -}}
        {%- endif %}
      value_template: >-
        {%- set s = state_attr('binary_sensor.motion_addon_update','addon') -%}
        {{- s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' -}}
    motion_addon_update:
      friendly_name: Add-on update
      icon_template: >-
        {%- if is_state_attr('binary_sensor.motion_addon_update','addon','age_home') -%}
          {{- 'mdi:home-heart' -}}
        {%- elif is_state_attr('binary_sensor.motion_addon_update','addon','motion_classic') -%}
           {{- 'mdi:eye-plus' -}}
        {%- else -%}
           {{- 'mdi:storefront' -}}
        {%- endif %}
      attribute_templates:
        addons: >-
          {% set addons = ['age_home','motion_classic'] -%}
          {{ addons }}
        addon: >-
          {{- 'unknown' -}}
        id: >-
          {{- 'unknown' -}}
        update: >-
          {{- 'unknown' -}}
        title: >-
          {{- 'unknown' -}}
        version: >-
          {{- 'unknown' -}}
        latest: >-
          {{- 'unknown' -}}
      value_template: >-
          {{- 'unknown' -}}
