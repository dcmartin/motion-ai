###
#
###

- unique_id: motion_person_bedtime_measurement
  trigger:
    - platform: state
      entity_id: 'sensor.motion_person_active'
      attribute: 'last_night'
    - name: 'motion_person_bedtime_measurement'
      state_class: 'measurement'
      device_class: 'pressure'
      unit_of_measurement: 'psi'
      state: >-
        {% set s = state_attr('sensor.motion_person_active','last_night').timestamp|default('null') -%}
        {%- if s|lower != 'null' -%}
          {%- set h = s|timestamp_custom('%H',true)|int(0) -%}
          {%- set m = ('%0.2f'|format(s|timestamp_custom('%M',true)|int(0)/60)) -%}
          {{ h|float + m|float }}
        {% else %}null{% endif %}


