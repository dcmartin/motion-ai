###
# homeassistant/sensor/motion/alarm.yaml
###

## general/app

- platform: template
  sensors:
    motion_alarm_count:
      friendly_name: Alarm count
      icon_template: 'mdi:counter'
      attribute_templates:
        message: >-
          {{- '**ALARM** ' + state_attr('binary_sensor.motion_alarm','title')|string + '<br>' + state_attr('binary_sensor.motion_alarm','message')|string }}
      value_template: >-
        {% set s = state_attr('binary_sensor.motion_alarm','count') %}
        {% if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' %}
          {{ s|int(0) }}
        {% else %}null{% endif %}

# count statistics

- platform: statistics
  name: motion_alarm_count_min
  entity_id: sensor.motion_alarms_count
  state_characteristic: value_min
  sampling_size: 100
  max_age:
    hours: 72

- platform: statistics
  name: motion_alarm_count_mean
  entity_id: sensor.motion_alarms_count
  state_characteristic: mean
  sampling_size: 100
  max_age:
    hours: 72

- platform: statistics
  name: motion_alarm_count_max
  entity_id: sensor.motion_alarms_count
  state_characteristic: value_max
  sampling_size: 100
  max_age:
    hours: 72

- platform: statistics
  name: motion_alarm_count_stdev
  entity_id: sensor.motion_alarms_count
  state_characteristic: standard_deviation
  sampling_size: 100
  max_age:
    hours: 72
