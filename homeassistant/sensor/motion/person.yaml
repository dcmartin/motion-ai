###
# homeassistant/sensor/motion/person.yaml
###

- platform: template
  sensors:
    motion_person_online_array:
      value_template: >-
        [{%- for state in states.person -%}
          {%- if loop.first -%}{%- else -%},{%- endif -%}
          {%- set s = state.state_with_unit|lower -%}
          {%- if s != 'unknown' and s != 'unavailable' and s != 'null' and s != 'none' -%}1{%- else -%}0{%- endif -%}
        {%- endfor -%}]
    motion_person_list:
      value_template: >-
        [{%- for state in states.person -%}
          {%- if loop.first -%}{%- else -%},{%- endif -%}
          {%- set s = state.entity_id|replace ('person.','') -%}
          "{{- s -}}"
        {%- endfor -%}]

- platform: template
  sensors:
    motion_person_agos:
      value_template: >-
        [{%- for state in states.person -%}
          {%- if loop.first -%}{%- else -%},{%- endif -%}
          {%- set s = state.entity_id|replace ('person.','') -%}
          {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|length > 0 %}
            {{- (utcnow().timestamp() - as_timestamp(states.person[s].last_updated))|int -}}
          {% else %}null{% endif %}
        {%- endfor -%}]
    motion_persons:
      value_template: >-
        {% set s = states('sensor.motion_person_list') %}
        {% if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' %}
          {% set s = s|from_json %}
          {% if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' and s is iterable and s|count > 0 %}
            {%- for r in s if r|lower != 'null' -%}
              {%- if loop.first -%}{%- else -%},{%- endif -%}
              {{- r -}}
            {%- endfor -%}
          {% else %}None{% endif %}
        {% else %}Pending{% endif %}
    motion_persons_ago:
      value_template: >-
        {% set s = states('sensor.motion_person_agos') %}
        {% if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' %}
          {% set s = s|from_json %}
          {% if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' and s is iterable and s|count > 0 %}
            {%- for r in s -%}
              {%- if loop.first -%}{%- else -%},{%- endif -%}
              {{- r -}}
            {%- endfor -%}
          {% else %}None{% endif %}
        {% else %}Pending{% endif %}

- platform: template
  sensors:
    motion_person_device_ago:
      unique_id: motion_person_device_ago
      friendly_name: 'ğŸ“± ago'
      icon_template: 'mdi:av-timer'
      unit_of_measurement: 's'
      value_template: >-
        {%- set s = states('sensor.motion_person_device') -%}
        {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' and s|length > 0 -%}
          {{- (utcnow().timestamp() - as_timestamp(states.device_tracker[s].last_updated))|int -}}
        {%- else -%}null{%- endif -%}
    motion_person_ago:
      unique_id: motion_person_ago
      friendly_name: 'ğŸ‘± ago'
      icon_template: 'mdi:av-timer'
      unit_of_measurement: 's'
      value_template: >
        {%- set s = states('sensor.motion_person') -%}
        {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' and s|length > 0 -%}
          {{- (utcnow().timestamp() - as_timestamp(states.person[s].last_updated))|int -}}
        {%- else -%}null{%- endif -%}
 
- platform: template
  sensors:
    motion_person_weeks:
      value_template: >
        {%- set s = states('input_number.motion_person_weeks') -%}
        {%- if s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'none' and s|lower != 'null' -%}
          {{ s|int -}}
        {%- else -%}{{- 1 -}}{%- endif -%}
    motion_person_weeks_timestamp:
      value_template: >
        {%- set s = states('sensor.motion_person_weeks') -%}
        {%- if s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'none' and s|lower != 'null' -%}
          {{ s|int * 7 * 24 * 60 * 60 -}}
        {%- else -%}{{- 604800 -}}{%- endif -%}

- platform: template
  sensors:
    motion_person_selected:
      value_template: >-
        {%- set s = states('input_select.motion_person') -%}
        {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' and s|lower != 'auto' -%}
          {{- s -}}
        {%- else -%}
          {%- set s = states.sensor.motion_person_selected.state -%}
          {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' -%}
            {{- s -}}
          {%- else -%}none{%- endif -%}
        {%- endif -%}
    motion_person:
      unique_id: motion_person
      friendly_name: 'Person (ğŸ‘±)'
      icon_template: 'mdi:card-account-mail'
      value_template: >-
        {%- set s = states('sensor.motion_person_calculator') -%}
        {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' and s|string|length > 0 -%}
          {{- s -}}
        {%- else -%}none{%- endif -%}
    motion_person_calculator:
      value_template: >-
        {%- set s = states('input_text.motion_person') -%}
        {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' -%}
          {%- set p = s -%}
        {%- endif -%}
        {%- set s = states('input_select.motion_person') -%}
        {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' and s|lower != 'auto' -%}
          {%- set p = s -%}
        {%- endif -%}
        {%- set s = states.sensor.motion_person.state -%}
        {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' and s|lower != 'auto' -%}
          {%- set p = s -%}
        {%- endif -%}
        {%- set s = states('sensor.motion_person_selected') -%}
        {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' and s|lower != 'auto' -%}
          {%- set p = s -%}
        {%- endif -%}
        {%- if p is defined %}
          {{- p -}}
        {%- else -%}
          {%- set s = states('sensor.motion_person_list') -%}
          {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' -%}
            {%- set s = s|from_json -%}
            {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' and s is iterable and s|length > 0 -%}
              {{- s|first -}}
            {%- else -%}none{%- endif -%}
          {%- else -%}none{%- endif -%}
        {%- endif -%}

- platform: template
  sensors:
    motion_person_device_selected:
      value_template: >-
        {%- set s = states('input_select.motion_person_device') -%}
        {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' and s|lower != 'auto' -%}
          {{- s -}}
        {%- else -%}
          {%- set s = states.sensor.motion_person_device_selected.state -%}
          {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' -%}
            {{- s -}}
          {%- else -%}none{%- endif -%}
        {%- endif -%}
    motion_person_device:
      unique_id: motion_person_device
      friendly_name: 'Device (ğŸ“±)'
      icon_template: 'mdi:card-account-phone'
      value_template: >-
        {%- set s = states('sensor.motion_person_device_calculator') -%}
        {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' and s|string|length > 0 -%}
          {{- s -}}
        {%- else -%}none{%- endif -%}
    motion_person_device_calculator:
      value_template: >-
        {%- set s = states('input_text.motion_person_device') -%}
        {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' and s|string|length > 0 -%}
          {%- set p = s -%}
        {%- endif -%}
        {%- set s = states('input_select.motion_person_device') -%}
        {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' and s|lower != 'auto' and s|string|length > 0 -%}
          {%- set p = s -%}
        {%- endif -%}
        {%- set s = states.sensor.motion_person_device.state -%}
        {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' and s|lower != 'auto' and s|string|length > 0 -%}
          {%- set p = s -%}
        {%- endif -%}
        {%- set s = states('sensor.motion_person_device_selected') -%}
        {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' and s|lower != 'auto' and s|string|length > 0 -%}
          {%- set p = s -%}
        {%- endif -%}
        {%- if p is defined %}
          {{- p -}}
        {%- else -%}
          {%- set s = states('sensor.motion_person') -%}
          {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' and s|string|length > 0 -%}
            {%- for state in states.device_tracker if s in state.entity_id and states(state.entity_id)|lower != 'unavailable' %}
              {% if loop.first %}{{- state.entity_id|replace ('device_tracker.','') -}}{% endif %}
            {%- endfor -%}
          {%- else -%}none{%- endif -%}
        {%- endif -%}

## location estimated

- platform: template
  sensors:
    motion_person_location_estimated:
      unique_id: motion_person_location_estimated
      friendly_name: 'ğŸ‘± estimated (ğŸ§)'
      unit_of_measurement: 'ğŸ§'
      icon_template: >-
        {{- 'mdi:map-marker-circle' -}}
      attribute_templates:
        id: >-
          {{ state_attr('person.' + states('sensor.motion_person')|string,'id')|string + '_estimate' }}
        entity_picture: >-
          {{ state_attr('person.' + states('sensor.motion_person'),'entity_picture') }}
        source: >-
          {{ 'none' }}
      value_template: >-
        {{- 'none' -}}
    motion_person_location_estimated_source:
      unique_id: motion_person_location_estimated_source
      friendly_name: 'ğŸ‘± estimated source (ğŸ¯)'
      icon_template: >-
        {{- 'mdi:crosshairs' -}}
      value_template: >-
        {%- set s = state_attr('sensor.motion_person_location_estimated','source') -%}
        {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' -%}
          {{- s -}}
        {%- else -%}
          {%- set s = states('sensor.motion_person_location_estimated_source') -%}
          {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' -%}
            {{- s -}}
          {%- else -%}Pending{%- endif -%}
        {%- endif -%}
    motion_person_location_estimated_distance:
      unique_id: motion_person_location_estimated_distance
      friendly_name: 'ğŸ‘± distance (est)'
      unit_of_measurement: 'm'
      icon_template: >-
        {{- 'mdi:ruler-square-compass' -}}
      value_template: >-
        {% set radius = 6372.797 %}
        {% set pi80 = pi|float / 180.0 %}
        {% set lat1 = state_attr('sensor.motion_person_location_estimated','latitude')|float * pi80 %}
        {% set lon1 = state_attr('sensor.motion_person_location_estimated','longitude')|float * pi80 %}
        {% if lat1 is number and lat1 != 0.0 and lon1 is number and lon2 != 0.0 %}
          {% set lat2 = state_attr('zone.home','latitude')|float * pi80 %}
          {% set lon2 = state_attr('zone.home','longitude')|float * pi80 %}
          {% set dlat = lat2 - lat1 %}
          {% set dlon = lon2 - lon1 %}
          {% set a = sin(dlat/2)*sin(dlat/2)+cos(lat1)*cos(lat2)*sin(dlon/2)*sin(dlon/2) %}
          {% set c = 2 * atan2(sqrt(a),sqrt(1-a)) %}
          {% set m = radius * c * 1000.0 %}
        {% endif %}
        {% if m is defined and m is number %}
          {{ '%0.3f'|format(m) }}
        {% else %}null{% endif %}

- platform: statistics
  name: motion_person_location_estimated_distance_statistics_1d
  entity_id: sensor.motion_person_location_estimated_distance
  sampling_size: 1000
  max_age:
    hours: 24

- platform: statistics
  name: motion_person_location_estimated_distance_statistics_1w
  entity_id: sensor.motion_person_location_estimated_distance
  sampling_size: 5000
  max_age:
    hours: 168

- platform: template
  sensors:
    motion_person_location_estimated_distance_mean_1d:
      friendly_name: 'ğŸ‘± distance (est) Î¼ (1d)'
      unit_of_measurement: 'm'
      icon_template: 'mdi:ruler-square-compass'
      value_template: >-
        {% if states('sensor.motion_person_location_estimated_distance_statistics_1d') != 'unknown' %}
          {{ states.sensor.motion_person_location_estimated_distance_statistics_1d.state|float }}
        {%- else -%}null{%- endif -%}
    motion_person_location_estimated_distance_min_1d:
      friendly_name: 'ğŸ‘± distance (est) min (1d)'
      unit_of_measurement: 'm'
      icon_template: 'mdi:ruler-square-compass'
      value_template: >-
        {% if states('sensor.motion_person_location_estimated_distance_statistics_1d') != 'unknown' %}
          {{ states.sensor.motion_person_location_estimated_distance_statistics_1d.attributes.min_value|int }}
        {%- else -%}null{%- endif -%}
    motion_person_location_estimated_distance_max_1d:
      friendly_name: 'ğŸ‘± distance (est) max (1d)'
      unit_of_measurement: 'm'
      icon_template: 'mdi:ruler-square-compass'
      value_template: >-
        {% if states('sensor.motion_person_location_estimated_distance_statistics_1d') != 'unknown' %}
          {{ states.sensor.motion_person_location_estimated_distance_statistics_1d.attributes.max_value|int }}
        {%- else -%}null{%- endif -%}
    motion_person_location_estimated_distance_stdev_1d:
      friendly_name: ğŸ‘± distance (est) stdev (1d)
      unit_of_measurement: 'm'
      icon_template: 'mdi:sigma-lower'
      value_template: >
        {% if states('sensor.motion_person_location_estimated_distance_statistics_1d') != 'unknown' %}
          {{ states.sensor.motion_person_location_estimated_distance_statistics_1d.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_person_location_estimated_distance_change_1d:
      friendly_name: ğŸ‘± distance (est) change (1d)
      unit_of_measurement: 'm'
      icon_template: 'mdi:ruler-square-compass'
      value_template: >
        {% if states('sensor.motion_person_location_estimated_distance_statistics_1d') != 'unknown' %}
          {{ states.sensor.motion_person_location_estimated_distance_statistics_1d.attributes.change|float }}
        {%- else -%}null{%- endif -%}
    motion_person_location_estimated_distance_mean_1w:
      friendly_name: 'ğŸ‘± distance (est) Î¼ (1w)'
      unit_of_measurement: 'm'
      icon_template: 'mdi:ruler-square-compass'
      value_template: >-
        {% if states('sensor.motion_person_location_estimated_distance_statistics_1w') != 'unknown' %}
          {{ states.sensor.motion_person_location_estimated_distance_statistics_1w.state|float }}
        {%- else -%}null{%- endif -%}
    motion_person_location_estimated_distance_min_1w:
      friendly_name: 'ğŸ‘± distance (est) min (1w)'
      unit_of_measurement: 'm'
      icon_template: 'mdi:ruler-square-compass'
      value_template: >-
        {% if states('sensor.motion_person_location_estimated_distance_statistics_1w') != 'unknown' %}
          {{ states.sensor.motion_person_location_estimated_distance_statistics_1w.attributes.min_value|int }}
        {%- else -%}null{%- endif -%}
    motion_person_location_estimated_distance_max_1w:
      friendly_name: 'ğŸ‘± distance (est) max (1w)'
      unit_of_measurement: 'm'
      icon_template: 'mdi:ruler-square-compass'
      value_template: >-
        {% if states('sensor.motion_person_location_estimated_distance_statistics_1w') != 'unknown' %}
          {{ states.sensor.motion_person_location_estimated_distance_statistics_1w.attributes.max_value|int }}
        {%- else -%}null{%- endif -%}
    motion_person_location_estimated_distance_stdev_1w:
      friendly_name: ğŸ‘± distance (est) stdev (1w)
      unit_of_measurement: 'm'
      icon_template: 'mdi:sigma-lower'
      value_template: >
        {% if states('sensor.motion_person_location_estimated_distance_statistics_1w') != 'unknown' %}
          {{ states.sensor.motion_person_location_estimated_distance_statistics_1w.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_person_location_estimated_distance_change_1w:
      friendly_name: ğŸ‘± distance (est) change (1w)
      unit_of_measurement: 'm'
      icon_template: 'mdi:ruler-square-compass'
      value_template: >
        {% if states('sensor.motion_person_location_estimated_distance_statistics_1w') != 'unknown' %}
          {{ states.sensor.motion_person_location_estimated_distance_statistics_1w.attributes.change|float }}
        {%- else -%}null{%- endif -%}

## home

- platform: template
  sensors:
    motion_person_home:
      unique_id: motion_person_home
      friendly_name: 'ğŸ‘± home'
      icon_template: >-
        {% if is_state('binary_sensor.motion_person_home','on') %}
          {{- 'mdi:home-variant' -}}
        {%- else %}
          {{- 'mdi:home-variant-outline' -}}
        {%- endif %}
      value_template: >-
        {%- if is_state('binary_sensor.motion_person_home','on') -%}Home{%- else -%}Away{%- endif -%}
    motion_person_location:
      unique_id: motion_person_location
      friendly_name: 'ğŸ‘± location'
      attribute_templates:
        id: >-
          {{ state_attr('person.' + states('sensor.motion_person'),'id') }}
        latitude: >-
          {{ state_attr('person.' + states('sensor.motion_person'),'latitude') }}
        longitude: >-
          {{ state_attr('person.' + states('sensor.motion_person'),'longitude') }}
        gps_accuracy: >-
          {{ state_attr('person.' + states('sensor.motion_person'),'gps_accuracy') }}
        source: >-
          {{ state_attr('person.' + states('sensor.motion_person'),'source') }}
        user_id: >-
          {{ state_attr('person.' + states('sensor.motion_person'),'user_id') }}
        entity_picture: >-
          {{ state_attr('person.' + states('sensor.motion_person'),'entity_picture') }}
      icon_template: >-
        {{- 'mdi:map-marker' -}}
      value_template: >-
        {{ states('person.' + states('sensor.motion_person')) }}

- platform: template
  sensors:
    motion_person_device_activity:
      unique_id: motion_person_device_activity
      friendly_name: 'ğŸ“± activity'
      icon_template: >-
        {%- set s = states('sensor.motion_person_device') -%}
        {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' -%}
          {% set s = states('sensor.' + s + '_activity')|lower %}
          {% if s == 'stationary' %}{{- 'mdi:sofa-single' -}}
          {% elif s == 'walking' %}{{- 'mdi:walk' -}}
          {% elif s == 'running' %}{{- 'mdi:run' -}}
          {% elif s == 'automotive' %}{{- 'mdi:car' -}}
          {% elif s == 'cycling' %}{{- 'mdi:bike' -}}
          {% else %}{{- 'mdi:crosshairs-question' -}}{% endif %}
        {% else %}{{- 'mdi:crosshairs-question' -}}{% endif %}
      value_template: >-
        {%- set s = states('sensor.motion_person_device') -%}
        {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' -%}
          {{ states('sensor.' + states('sensor.motion_person_device') + '_activity') }}
        {%- else -%}null{%- endif -%}

- platform: template
  sensors:
    motion_person_device_battery:
      unique_id: motion_person_device_battery
      friendly_name: 'Battery'
      icon_template: >-
        {%- if states('sensor.motion_person_device_battery_state')|lower == 'charging' %}
          {{- 'mdi:battery-charging' -}}
        {%- else %}
          {%- set s = states('sensor.motion_person_device_battery_level') %}
          {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' -%}
            {%- if s|int >= 75 %}
              {{- 'mdi:battery-high' -}}
            {%- elif s|int >= 50 %}
              {{- 'mdi:battery-medium' -}}
            {%- elif s|int >= 25 %}
              {{- 'mdi:battery-low' -}}
            {%- else %}
              {{- 'mdi:battery-outline' -}}
            {% endif %}
          {%- else %}
            {{- 'mdi:battery' -}}
          {% endif %}
        {% endif %}
      value_template: >-
        {%- if is_state('binary_sensor.motion_person_smartphone_powersave','on') -%}
            {{- 'Power-save mode' -}}
        {%- else -%}
          {%- set s = states('sensor.motion_person_device_battery_state') -%}
          {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' -%}
            {{- s -}}
          {%- else -%}
            {{- 'Pending' -}}
          {%- endif -%}
        {%- endif -%}
        {%- set s = states('sensor.motion_person_device_battery_level') -%}
        {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' -%}
          {{- '; ' + s + '%' -}}
        {%- endif -%}

- platform: template
  sensors:
    motion_person_device_location:
      unique_id: motion_person_device_location
      friendly_name: 'ğŸ“± location'
      icon_template: 'mdi:map'
      value_template: >-
        {%- set s = states('sensor.motion_person_device') -%}
        {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' -%}
          {{ '%0.4f' | format(state_attr('device_tracker.' + s,'latitude')|float) -}},
          {{- '%0.4f' | format(state_attr('device_tracker.' + s,'longitude')|float) -}}
          {{- ' Â±' -}}
          {{- state_attr('device_tracker.' + s,'gps_accuracy') -}}m
          ({{- state_attr('device_tracker.' + s,'source_type')|upper -}});
          {{ state_attr('device_tracker.' + s,'altitude')|int -}}
          {{- 'Â±' -}}
          {{- state_attr('device_tracker.' + s,'vertical_accuracy') -}}m
        {%- else -%}Pending{%- endif -%}

- platform: template
  sensors:
    motion_person_device_bssid:
      unique_id: motion_person_device_bssid
      friendly_name: 'ğŸ“± BSSID'
      icon_template: 'mdi:signal-cellular-outline'
      value_template: >-
        {%- set s = states('sensor.motion_person_device') -%}
        {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' -%}
          {{ states('sensor.' + states('sensor.motion_person_device') + '_basid') }}
        {%- else -%}null{%- endif -%}
    motion_person_device_battery_state:
      unique_id: motion_person_device_battery_state
      friendly_name: 'Battery'
      icon_template: 'mdi:battery-outline'
      value_template: >-
        {%- set s = states('sensor.motion_person_device') -%}
        {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' -%}
          {{ states('sensor.' + states('sensor.motion_person_device') + '_battery_state') }}
        {%- else -%}null{%- endif -%}
    motion_person_device_connection_type:
      unique_id: motion_person_device_connection_type
      friendly_name: 'Network connection'
      icon_template: 'mdi:cellphone-wireless'
      value_template: >-
        {%- set s = states('sensor.motion_person_device') -%}
        {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' -%}
          {{ states('sensor.' + states('sensor.motion_person_device') + '_connection_type') }}
        {%- else -%}null{%- endif -%}
    motion_person_device_geocoded_location:
      unique_id: motion_person_device_geocoded_location
      friendly_name: 'Location'
      icon_template: 'mdi:map-marker'
      value_template: >-
        {%- set s = states('sensor.motion_person_device') -%}
        {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' -%}
          {{ states('sensor.' + states('sensor.motion_person_device') + '_geocoded_location') }}
        {%- else -%}null{%- endif -%}
    motion_person_device_last_update_trigger:
      unique_id: motion_person_device_last_update_trigger
      friendly_name: 'Last update'
      icon_template: 'mdi:alarm-check'
      value_template: >-
        {%- set s = states('sensor.motion_person_device') -%}
        {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' -%}
          {{ states('sensor.' + states('sensor.motion_person_device') + '_last_update_trigger') }}
        {%- else -%}null{%- endif -%}
    motion_person_device_ssid:
      unique_id: motion_person_device_ssid
      friendly_name: 'WiFi SSID'
      icon_template: 'mdi:wifi'
      value_template: >-
        {%- set s = states('sensor.motion_person_device') -%}
        {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' -%}
          {{ states('sensor.' + states('sensor.motion_person_device') + '_ssid') }}
        {%- else -%}null{%- endif -%}
    motion_person_device_storage:
      unique_id: motion_person_device_storage
      friendly_name: 'Storage available'
      icon_template: 'mdi:database'
      unit_of_measurement: 'â„€'
      value_template: >-
        {%- set s = states('sensor.motion_person_device') -%}
        {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' -%}
          {{ states('sensor.' + s + '_storage') }}
        {%- else -%}null{%- endif -%}
    motion_person_device_status:
      unique_id: motion_person_device_status
      friendly_name: 'ğŸ“±  status'
      icon_template: 'mdi:cellphone'
      value_template: >-
        {%- set s = states('sensor.motion_person_device') -%}
        {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' -%}
          {{- states('device_tracker.' + s) -}}
        {%- else -%}Pending{%- endif -%}
    motion_person_device_battery_level:
      unique_id: motion_person_device_battery_level
      friendly_name: 'Battery level'
      icon_template: 'mdi:battery'
      unit_of_measurement: 'ğŸ”‹'
      value_template: >-
        {%- set s = states('sensor.motion_person_device') -%}
        {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' -%}
          {{- state_attr('device_tracker.' + s,'battery_level') -}}
        {%- else -%}null{%- endif -%}

- platform: template
  sensors:
    motion_person_device_source_type:
      unique_id: motion_person_device_source_type
      friendly_name: 'ğŸ—º source'
      icon_template: 'mdi:map'
      value_template: >-
        {%- set s = states('sensor.motion_person_device') -%}
        {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' -%}
          {{- state_attr('device_tracker.' + s,'source_type') -}}
        {%- else -%}null{%- endif -%}
    motion_person_device_latitude:
      unique_id: motion_person_device_latitude
      friendly_name: 'ğŸ—º latitude'
      icon_template: 'mdi:latitude'
      value_template: >-
        {%- set s = states('sensor.motion_person_device') -%}
        {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' -%}
          {{- state_attr('device_tracker.' + s,'latitude') -}}
        {%- else -%}null{%- endif -%}
    motion_person_device_longitude:
      unique_id: motion_person_device_longitude
      friendly_name: 'ğŸ—º longitude'
      icon_template: 'mdi:longitude'
      value_template: >-
        {%- set s = states('sensor.motion_person_device') -%}
        {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' -%}
          {{- state_attr('device_tracker.' + s,'longitude') -}}
        {%- else -%}null{%- endif -%}
    motion_person_device_gps_accuracy:
      unique_id: motion_person_device_gps_accuracy
      friendly_name: 'ğŸ—º accuracy (x,y)'
      icon_template: 'mdi:human'
      unit_of_measurement: 'm'
      value_template: >-
        {%- set s = states('sensor.motion_person_device') -%}
        {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' -%}
          {{- state_attr('device_tracker.' + s,'gps_accuracy') -}}
        {%- else -%}null{%- endif -%}
    motion_person_device_altitude:
      unique_id: motion_person_device_altitude
      friendly_name: 'ğŸ—º altitude'
      icon_template: 'mdi:altimeter'
      unit_of_measurement: 'm'
      value_template: >-
        {%- set s = states('sensor.motion_person_device') -%}
        {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' -%}
          {{- state_attr('device_tracker.' + s,'altitude') -}}
        {%- else -%}null{%- endif -%}
    motion_person_device_vertical_accuracy:
      unique_id: motion_person_device_vertical_accuracy
      friendly_name: 'ğŸ—º accuracy (z)'
      icon_template: 'mdi:human'
      unit_of_measurement: 'm'
      value_template: >-
        {%- set s = states('sensor.motion_person_device') -%}
        {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' -%}
          {{- state_attr('device_tracker.' + s,'vertical_accuracy') -}}
        {%- else -%}null{%- endif -%}
    motion_person_steps:
      unique_id: motion_person_steps
      friendly_name: 'Steps'
      icon_template: 'mdi:foot-print'
      unit_of_measurement: 'ğŸ¦¶'
      value_template: >-
        {%- set s = states('sensor.motion_person_device') -%}
        {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' -%}
          {%- set s = states('sensor.' + s + '_steps') -%}
          {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' -%}
            {{- s -}}
          {%- else -%}null{%- endif -%}
        {%- else -%}null{%- endif -%}
    motion_person_pedometer_pace:
      unique_id: motion_person_pedometer_pace
      friendly_name: 'Pedometer pace'
      unit_of_measurement: 'm/s'
      icon_template: 'mdi:shoe-print'
      value_template: >-
        {%- set s = states('sensor.motion_person_device') -%}
        {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' -%}
          {{ states('sensor.' + s + '_average_active_pace') }}
        {%- else -%}null{%- endif -%}
    motion_person_floors_ascended:
      unique_id: motion_person_floors_ascended
      friendly_name: 'Floors up'
      icon_template: 'mdi:stairs'
      value_template: >-
        {%- set s = states('sensor.motion_person_device') -%}
        {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' -%}
          {%- set s = states('sensor.' + s + '_floors_ascended') -%}
          {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' -%}
            {{- s -}}
          {%- else -%}null{%- endif -%}
        {%- else -%}null{%- endif -%}
    motion_person_floors_descended:
      unique_id: motion_person_floors_descended
      friendly_name: 'Floors down'
      icon_template: 'mdi:stairs'
      value_template: >-
        {%- set s = states('sensor.motion_person_device') -%}
        {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' -%}
          {%- set s = states('sensor.' + s + '_floors_descended') -%}
          {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' -%}
            {{- s -}}
          {%- else -%}null{%- endif -%}
        {%- else -%}null{%- endif -%}
    motion_person_distance:
      unique_id: motion_person_distance
      friendly_name: 'Distance'
      icon_template: 'mdi:walk'
      unit_of_measurement: 'm'
      value_template: >-
        {%- set s = states('sensor.motion_person_device') -%}
        {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' -%}
          {%- set s = states('sensor.' + s + '_distance') -%}
          {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' -%}
            {{- s -}}
          {%- else -%}null{%- endif -%}
        {%- else -%}null{%- endif -%}
    motion_person_frontmost_app:
      unique_id: motion_person_frontmost_app
      friendly_name: 'Current app'
      icon_template: 'mdi:cellphone-play'
      value_template: >-
        {%- set s = states('sensor.motion_person_device') -%}
        {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' -%}
          {%- set s = states('sensor.' + s + '_frontmost_app') -%}
          {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' -%}
            {{- s -}}
          {%- else -%}null{%- endif -%}
        {%- else -%}null{%- endif -%}

- platform: statistics
  name: motion_person_distance_statistics_1d
  entity_id: sensor.motion_person_distance
  sampling_size: 100
  max_age:
    hours: 24

- platform: statistics
  name: motion_person_distance_statistics_1w
  entity_id: sensor.motion_person_distance
  sampling_size: 500
  max_age:
    hours: 168

- platform: template
  sensors:
    motion_person_distance_mean_1d:
      friendly_name: 'Person distance Î¼ (1d)'
      unit_of_measurement: 'm'
      icon_template: 'mdi:hike'
      value_template: >-
        {% if states('sensor.motion_person_distance_statistics_1d') != 'unknown' %}
          {{ states.sensor.motion_person_distance_statistics_1d.state|float }}
        {%- else -%}null{%- endif -%}
    motion_person_distance_min_1d:
      friendly_name: 'Person distance min (1d)'
      unit_of_measurement: 'm'
      icon_template: 'mdi:hike'
      value_template: >-
        {% if states('sensor.motion_person_distance_statistics_1d') != 'unknown' %}
          {{ states.sensor.motion_person_distance_statistics_1d.attributes.min_value|int }}
        {%- else -%}null{%- endif -%}
    motion_person_distance_max_1d:
      friendly_name: 'Person distance max (1d)'
      unit_of_measurement: 'm'
      icon_template: 'mdi:hike'
      value_template: >-
        {% if states('sensor.motion_person_distance_statistics_1d') != 'unknown' %}
          {{ states.sensor.motion_person_distance_statistics_1d.attributes.max_value|int }}
        {%- else -%}null{%- endif -%}
    motion_person_distance_stdev_1d:
      friendly_name: Person distance stdev (1d)
      unit_of_measurement: 'm'
      icon_template: 'mdi:sigma-lower'
      value_template: >
        {% if states('sensor.motion_person_distance_statistics_1d') != 'unknown' %}
          {{ states.sensor.motion_person_distance_statistics_1d.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_person_distance_change_1d:
      friendly_name: Person distance change (1d)
      unit_of_measurement: 'm'
      icon_template: 'mdi:hike'
      value_template: >
        {% if states('sensor.motion_person_distance_statistics_1d') != 'unknown' %}
          {{ states.sensor.motion_person_distance_statistics_1d.attributes.change|float }}
        {%- else -%}null{%- endif -%}
    motion_person_distance_mean_1w:
      friendly_name: 'Person distance Î¼ (1w)'
      unit_of_measurement: 'm'
      icon_template: 'mdi:hike'
      value_template: >-
        {% if states('sensor.motion_person_distance_statistics_1w') != 'unknown' %}
          {{ states.sensor.motion_person_distance_statistics_1w.state|float }}
        {%- else -%}null{%- endif -%}
    motion_person_distance_min_1w:
      friendly_name: 'Person distance min (1w)'
      unit_of_measurement: 'm'
      icon_template: 'mdi:hike'
      value_template: >-
        {% if states('sensor.motion_person_distance_statistics_1w') != 'unknown' %}
          {{ states.sensor.motion_person_distance_statistics_1w.attributes.min_value|int }}
        {%- else -%}null{%- endif -%}
    motion_person_distance_max_1w:
      friendly_name: 'Person distance max (1w)'
      unit_of_measurement: 'm'
      icon_template: 'mdi:hike'
      value_template: >-
        {% if states('sensor.motion_person_distance_statistics_1w') != 'unknown' %}
          {{ states.sensor.motion_person_distance_statistics_1w.attributes.max_value|int }}
        {%- else -%}null{%- endif -%}
    motion_person_distance_stdev_1w:
      friendly_name: Person distance stdev (1w)
      unit_of_measurement: 'm'
      icon_template: 'mdi:sigma-lower'
      value_template: >
        {% if states('sensor.motion_person_distance_statistics_1w') != 'unknown' %}
          {{ states.sensor.motion_person_distance_statistics_1w.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_person_distance_change_1w:
      friendly_name: Person distance change (1w)
      unit_of_measurement: 'm'
      icon_template: 'mdi:hike'
      value_template: >
        {% if states('sensor.motion_person_distance_statistics_1w') != 'unknown' %}
          {{ states.sensor.motion_person_distance_statistics_1w.attributes.change|float }}
        {%- else -%}null{%- endif -%}

- platform: template
  sensors:
    motion_person_ids:
      value_template: >-
        [{%- for state in states.person -%}
          {%- if loop.first -%}{%- else -%},{%- endif -%}
          {%- set s = state.entity_id|replace ('person.','') -%}
          {{- states.person[s].attributes.id -}}
        {%- endfor -%}]

- platform: template
  sensors:
    motion_person_count:
      unique_id: motion_person_count
      friendly_name: Person count
      icon_template: 'mdi:counter'
      unit_of_measurement: 'ğŸ‘±'
      value_template: >-
        {{ states('sensor.motion_person_online_array')|from_json|length }}

- platform: template
  sensors:
    motion_person_count_online:
      unique_id: motion_person_count_online
      friendly_name: Person on-line count
      icon_template: 'mdi:counter'
      unit_of_measurement: 'ğŸ‘±'
      value_template: >-
        {{ states('sensor.motion_person_online_array')|from_json|sum }}

- platform: template
  sensors:
    motion_person_count_offline:
      unique_id: motion_person_count_offline
      friendly_name: Person off-line count
      icon_template: 'mdi:counter'
      unit_of_measurement: 'ğŸ‘±'
      value_template: >-
        {{ states('sensor.motion_person_count')|int - states('sensor.motion_person_count_online')|int  }}

- platform: template
  sensors:
    motion_person_online_percent:
      unique_id: motion_person_online_percent
      friendly_name: Person on-line percent
      icon_template: 'mdi:account'
      unit_of_measurement: '%'
      value_template: >-
        {% set c = states('sensor.motion_person_count')|int %}
        {% if c > 0 %}
          {% set o = states('sensor.motion_person_count_online')|int %}
          {{ (o / c * 100)|int }}
        {% else %}null{% endif %}

- platform: template
  sensors:
    motion_person_online_status:
      unique_id: motion_person_online_status
      friendly_name: Person on-line status 
      icon_template: 'mdi:account'
      value_template: >-
        {{ states('sensor.motion_person_count_online') -}}/{{- states('sensor.motion_person_count') }}ğŸ‘±;
        {{ states('sensor.motion_person_online_percent') -}}%

###
# motion_person_device_ago_mean
###

- platform: statistics
  name: motion_person_device_ago_statistics_1d
  entity_id: sensor.motion_person_device_ago
  sampling_size: 100
  max_age:
    hours: 24

- platform: statistics
  name: motion_person_device_ago_statistics_1w
  entity_id: sensor.motion_person_device_ago
  sampling_size: 500
  max_age:
    hours: 168

- platform: template
  sensors:
    motion_person_device_ago_mean_1d:
      friendly_name: 'Device ago Î¼ (1d)'
      unit_of_measurement: 'ğŸ¦¶'
      icon_template: 'mdi:walk'
      value_template: >-
        {% if states('sensor.motion_person_device_ago_statistics_1d') != 'unknown' %}
          {{ states.sensor.motion_person_device_ago_statistics_1d.state|float }}
        {%- else -%}null{%- endif -%}
    motion_person_device_ago_min_1d:
      friendly_name: 'Device ago min (1d)'
      unit_of_measurement: 'ğŸ¦¶'
      icon_template: 'mdi:walk'
      value_template: >-
        {% if states('sensor.motion_person_device_ago_statistics_1d') != 'unknown' %}
          {{ states.sensor.motion_person_device_ago_statistics_1d.attributes.min_value|int }}
        {%- else -%}null{%- endif -%}
    motion_person_device_ago_max_1d:
      friendly_name: 'Device ago max (1d)'
      unit_of_measurement: 'ğŸ¦¶'
      icon_template: 'mdi:walk'
      value_template: >-
        {% if states('sensor.motion_person_device_ago_statistics_1d') != 'unknown' %}
          {{ states.sensor.motion_person_device_ago_statistics_1d.attributes.max_value|int }}
        {%- else -%}null{%- endif -%}
    motion_person_device_ago_stdev_1d:
      friendly_name: Device ago stdev (1d)
      unit_of_measurement: 'ğŸ¦¶'
      icon_template: 'mdi:sigma-lower'
      value_template: >
        {% if states('sensor.motion_person_device_ago_statistics_1d') != 'unknown' %}
          {{ states.sensor.motion_person_device_ago_statistics_1d.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_person_device_ago_change_1d:
      friendly_name: Device ago change (1d)
      unit_of_measurement: 'ğŸ¦¶'
      icon_template: 'mdi:walk'
      value_template: >
        {% if states('sensor.motion_person_device_ago_statistics_1d') != 'unknown' %}
          {{ states.sensor.motion_person_device_ago_statistics_1d.attributes.change|float }}
        {%- else -%}null{%- endif -%}
    motion_person_device_ago_mean_1w:
      friendly_name: 'Device ago Î¼ (1w)'
      unit_of_measurement: 'ğŸ¦¶'
      icon_template: 'mdi:walk'
      value_template: >-
        {% if states('sensor.motion_person_device_ago_statistics_1w') != 'unknown' %}
          {{ states.sensor.motion_person_device_ago_statistics_1w.state|float }}
        {%- else -%}null{%- endif -%}
    motion_person_device_ago_min_1w:
      friendly_name: 'Device ago min (1w)'
      unit_of_measurement: 'ğŸ¦¶'
      icon_template: 'mdi:walk'
      value_template: >-
        {% if states('sensor.motion_person_device_ago_statistics_1w') != 'unknown' %}
          {{ states.sensor.motion_person_device_ago_statistics_1w.attributes.min_value|int }}
        {%- else -%}null{%- endif -%}
    motion_person_device_ago_max_1w:
      friendly_name: 'Device ago max (1w)'
      unit_of_measurement: 'ğŸ¦¶'
      icon_template: 'mdi:walk'
      value_template: >-
        {% if states('sensor.motion_person_device_ago_statistics_1w') != 'unknown' %}
          {{ states.sensor.motion_person_device_ago_statistics_1w.attributes.max_value|int }}
        {%- else -%}null{%- endif -%}
    motion_person_device_ago_stdev_1w:
      friendly_name: Device ago stdev (1w)
      unit_of_measurement: 'ğŸ¦¶'
      icon_template: 'mdi:sigma-lower'
      value_template: >
        {% if states('sensor.motion_person_device_ago_statistics_1w') != 'unknown' %}
          {{ states.sensor.motion_person_device_ago_statistics_1w.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_person_device_ago_change_1w:
      friendly_name: Device ago change (1w)
      unit_of_measurement: 'ğŸ¦¶'
      icon_template: 'mdi:walk'
      value_template: >
        {% if states('sensor.motion_person_device_ago_statistics_1w') != 'unknown' %}
          {{ states.sensor.motion_person_device_ago_statistics_1w.attributes.change|float }}
        {%- else -%}null{%- endif -%}

###
## 1d
###

# steps statistics

- platform: statistics
  name: motion_person_steps_statistics_1d
  entity_id: sensor.motion_person_steps
  sampling_size: 100
  max_age:
    hours: 24

- platform: template
  sensors:
    motion_person_steps_mean_1d:
      friendly_name: 'Steps Î¼ (1d)'
      unit_of_measurement: 'ğŸ¦¶'
      icon_template: 'mdi:walk'
      value_template: >-
        {% if states('sensor.motion_person_steps_statistics_1d') != 'unknown' %}
          {{ states.sensor.motion_person_steps_statistics_1d.state|float }}
        {%- else -%}null{%- endif -%}
    motion_person_steps_min_1d:
      friendly_name: 'Steps min (1d)'
      unit_of_measurement: 'ğŸ¦¶'
      icon_template: 'mdi:walk'
      value_template: >-
        {% if states('sensor.motion_person_steps_statistics_1d') != 'unknown' %}
          {{ states.sensor.motion_person_steps_statistics_1d.attributes.min_value|int }}
        {%- else -%}null{%- endif -%}
    motion_person_steps_max_1d:
      friendly_name: 'Steps max (1d)'
      unit_of_measurement: 'ğŸ¦¶'
      icon_template: 'mdi:walk'
      value_template: >-
        {% if states('sensor.motion_person_steps_statistics_1d') != 'unknown' %}
          {{ states.sensor.motion_person_steps_statistics_1d.attributes.max_value|int }}
        {%- else -%}null{%- endif -%}
    motion_person_steps_stdev_1d:
      friendly_name: Person steps stdev (1d)
      unit_of_measurement: 'ğŸ¦¶'
      icon_template: 'mdi:sigma-lower'
      value_template: >
        {% if states('sensor.motion_person_steps_statistics_1d') != 'unknown' %}
          {{ states.sensor.motion_person_steps_statistics_1d.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_person_steps_change_1d:
      friendly_name: Person steps change (1d)
      unit_of_measurement: 'ğŸ¦¶'
      icon_template: 'mdi:walk'
      value_template: >
        {% if states('sensor.motion_person_steps_statistics_1d') != 'unknown' %}
          {{ states.sensor.motion_person_steps_statistics_1d.attributes.change|float }}
        {%- else -%}null{%- endif -%}

###
## pedometer_pace
###

# 1d

- platform: statistics
  name: motion_person_pedometer_pace_statistics_1d
  entity_id: sensor.motion_person_pedometer_pace
  sampling_size: 100
  max_age:
    hours: 24

- platform: template
  sensors:
    motion_person_pedometer_pace_mean_1d:
      friendly_name: 'Pace Î¼ (1d)'
      unit_of_measurement: 'm/s'
      icon_template: 'mdi:shoe-print'
      value_template: >-
        {% if states('sensor.motion_person_pedometer_pace_statistics_1d') != 'unknown' %}
          {{ states.sensor.motion_person_pedometer_pace_statistics_1d.state|float }}
        {%- else -%}null{%- endif -%}
    motion_person_pedometer_pace_min_1d:
      friendly_name: 'Pace min (1d)'
      unit_of_measurement: 'm/s'
      icon_template: 'mdi:shoe-print'
      value_template: >-
        {% if states('sensor.motion_person_pedometer_pace_statistics_1d') != 'unknown' %}
          {{ states.sensor.motion_person_pedometer_pace_statistics_1d.attributes.min_value|int }}
        {%- else -%}null{%- endif -%}
    motion_person_pedometer_pace_max_1d:
      friendly_name: 'Pace max (1d)'
      unit_of_measurement: 'm/s'
      icon_template: 'mdi:shoe-print'
      value_template: >-
        {% if states('sensor.motion_person_pedometer_pace_statistics_1d') != 'unknown' %}
          {{ states.sensor.motion_person_pedometer_pace_statistics_1d.attributes.max_value|int }}
        {%- else -%}null{%- endif -%}
    motion_person_pedometer_pace_stdev_1d:
      friendly_name: Pace stdev (1d)
      unit_of_measurement: 'm/s'
      icon_template: 'mdi:sigma-lower'
      value_template: >
        {% if states('sensor.motion_person_pedometer_pace_statistics_1d') != 'unknown' %}
          {{ states.sensor.motion_person_pedometer_pace_statistics_1d.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_person_pedometer_pace_change_1d:
      friendly_name: Pace change (1d)
      unit_of_measurement: 'm/s'
      icon_template: 'mdi:shoe-print'
      value_template: >
        {% if states('sensor.motion_person_pedometer_pace_statistics_1d') != 'unknown' %}
          {{ states.sensor.motion_person_pedometer_pace_statistics_1d.attributes.change|float }}
        {%- else -%}null{%- endif -%}

# 1w

- platform: statistics
  name: motion_person_pedometer_pace_statistics_1w
  entity_id: sensor.motion_person_pedometer_pace
  sampling_size: 500
  max_age:
    hours: 168

- platform: template
  sensors:
    motion_person_pedometer_pace_mean_1w:
      friendly_name: 'Pace Î¼ (1w)'
      unit_of_measurement: 'm/s'
      icon_template: 'mdi:shoe-print'
      value_template: >-
        {% if states('sensor.motion_person_pedometer_pace_statistics_1w') != 'unknown' %}
          {{ states.sensor.motion_person_pedometer_pace_statistics_1w.state|float }}
        {%- else -%}null{%- endif -%}
    motion_person_pedometer_pace_min_1w:
      friendly_name: 'Pace min (1w)'
      unit_of_measurement: 'm/s'
      icon_template: 'mdi:shoe-print'
      value_template: >-
        {% if states('sensor.motion_person_pedometer_pace_statistics_1w') != 'unknown' %}
          {{ states.sensor.motion_person_pedometer_pace_statistics_1w.attributes.min_value|int }}
        {%- else -%}null{%- endif -%}
    motion_person_pedometer_pace_max_1w:
      friendly_name: 'Pace max (1w)'
      unit_of_measurement: 'm/s'
      icon_template: 'mdi:shoe-print'
      value_template: >-
        {% if states('sensor.motion_person_pedometer_pace_statistics_1w') != 'unknown' %}
          {{ states.sensor.motion_person_pedometer_pace_statistics_1w.attributes.max_value|int }}
        {%- else -%}null{%- endif -%}
    motion_person_pedometer_pace_stdev_1w:
      friendly_name: Pace stdev (1w)
      unit_of_measurement: 'm/s'
      icon_template: 'mdi:sigma-lower'
      value_template: >
        {% if states('sensor.motion_person_pedometer_pace_statistics_1w') != 'unknown' %}
          {{ states.sensor.motion_person_pedometer_pace_statistics_1w.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_person_pedometer_pace_change_1w:
      friendly_name: Pace change (1w)
      unit_of_measurement: 'm/s'
      icon_template: 'mdi:shoe-print'
      value_template: >
        {% if states('sensor.motion_person_pedometer_pace_statistics_1w') != 'unknown' %}
          {{ states.sensor.motion_person_pedometer_pace_statistics_1w.attributes.change|float }}
        {%- else -%}null{%- endif -%}

# 1m

- platform: statistics
  name: motion_person_pedometer_pace_statistics_1m
  entity_id: sensor.motion_person_pedometer_pace
  sampling_size: 500
  max_age:
    hours: 672

- platform: template
  sensors:
    motion_person_pedometer_pace_mean_1m:
      friendly_name: 'Pace Î¼ (1m)'
      unit_of_measurement: 'm/s'
      icon_template: 'mdi:shoe-print'
      value_template: >-
        {% if states('sensor.motion_person_pedometer_pace_statistics_1m') != 'unknown' %}
          {{ states.sensor.motion_person_pedometer_pace_statistics_1m.state|float }}
        {%- else -%}null{%- endif -%}
    motion_person_pedometer_pace_min_1m:
      friendly_name: 'Pace min (1m)'
      unit_of_measurement: 'm/s'
      icon_template: 'mdi:shoe-print'
      value_template: >-
        {% if states('sensor.motion_person_pedometer_pace_statistics_1m') != 'unknown' %}
          {{ states.sensor.motion_person_pedometer_pace_statistics_1m.attributes.min_value|int }}
        {%- else -%}null{%- endif -%}
    motion_person_pedometer_pace_max_1m:
      friendly_name: 'Pace max (1m)'
      unit_of_measurement: 'm/s'
      icon_template: 'mdi:shoe-print'
      value_template: >-
        {% if states('sensor.motion_person_pedometer_pace_statistics_1m') != 'unknown' %}
          {{ states.sensor.motion_person_pedometer_pace_statistics_1m.attributes.max_value|int }}
        {%- else -%}null{%- endif -%}
    motion_person_pedometer_pace_stdev_1m:
      friendly_name: Pace stdev (1m)
      unit_of_measurement: 'm/s'
      icon_template: 'mdi:sigma-lower'
      value_template: >
        {% if states('sensor.motion_person_pedometer_pace_statistics_1m') != 'unknown' %}
          {{ states.sensor.motion_person_pedometer_pace_statistics_1m.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_person_pedometer_pace_change_1m:
      friendly_name: Pace change (1m)
      unit_of_measurement: 'm/s'
      icon_template: 'mdi:shoe-print'
      value_template: >
        {% if states('sensor.motion_person_pedometer_pace_statistics_1m') != 'unknown' %}
          {{ states.sensor.motion_person_pedometer_pace_statistics_1m.attributes.change|float }}
        {%- else -%}null{%- endif -%}

# floors_ascended statistics

- platform: statistics
  name: motion_person_floors_ascended_statistics_1d
  entity_id: sensor.motion_person_floors_ascended
  sampling_size: 100
  max_age:
    hours: 24

- platform: template
  sensors:
    motion_person_floors_ascended_mean_1d:
      friendly_name: 'Floors up Î¼ (1d)'
      unit_of_measurement: 'â¬†'
      icon_template: 'mdi:stairs-up'
      value_template: >-
        {% if states('sensor.motion_person_floors_ascended_statistics_1d') != 'unknown' %}
          {{ states.sensor.motion_person_floors_ascended_statistics_1d.state|float }}
        {%- else -%}null{%- endif -%}
    motion_person_floors_ascended_min_1d:
      friendly_name: 'Floors up min (1d)'
      unit_of_measurement: 'â¬†'
      icon_template: 'mdi:stairs-up'
      value_template: >-
        {% if states('sensor.motion_person_floors_ascended_statistics_1d') != 'unknown' %}
          {{ states.sensor.motion_person_floors_ascended_statistics_1d.attributes.min_value|int }}
        {%- else -%}null{%- endif -%}
    motion_person_floors_ascended_max_1d:
      friendly_name: 'Floors up max (1d)'
      unit_of_measurement: 'â¬†'
      icon_template: 'mdi:stairs-up'
      value_template: >-
        {% if states('sensor.motion_person_floors_ascended_statistics_1d') != 'unknown' %}
          {{ states.sensor.motion_person_floors_ascended_statistics_1d.attributes.max_value|int }}
        {%- else -%}null{%- endif -%}
    motion_person_floors_ascended_stdev_1d:
      friendly_name: 'Floors up stdev (1d)'
      unit_of_measurement: 'â¬†'
      icon_template: 'mdi:sigma-lower'
      value_template: >
        {% if states('sensor.motion_person_floors_ascended_statistics_1d') != 'unknown' %}
          {{ states.sensor.motion_person_floors_ascended_statistics_1d.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_person_floors_ascended_change_1d:
      friendly_name: 'Floors up change (1d)'
      unit_of_measurement: 'â¬†'
      icon_template: 'mdi:stairs-up'
      value_template: >
        {% if states('sensor.motion_person_floors_ascended_statistics_1d') != 'unknown' %}
          {{ states.sensor.motion_person_floors_ascended_statistics_1d.attributes.change|float }}
        {%- else -%}null{%- endif -%}

# floors_descended statistics

- platform: statistics
  name: motion_person_floors_descended_statistics_1d
  entity_id: sensor.motion_person_floors_descended
  sampling_size: 500
  max_age:
    hours: 24

- platform: template
  sensors:
    motion_person_floors_descended_mean_1d:
      friendly_name: 'Floors down Î¼ (1d)'
      unit_of_measurement: 'â¬‡'
      icon_template: 'mdi:stairs-down'
      value_template: >-
        {% if states('sensor.motion_person_floors_descended_statistics_1d') != 'unknown' %}
          {{ states.sensor.motion_person_floors_descended_statistics_1d.state|float }}
        {%- else -%}null{%- endif -%}
    motion_person_floors_descended_min_1d:
      friendly_name: 'Floors down min (1d)'
      unit_of_measurement: 'â¬‡'
      icon_template: 'mdi:stairs-down'
      value_template: >-
        {% if states('sensor.motion_person_floors_descended_statistics_1d') != 'unknown' %}
          {{ states.sensor.motion_person_floors_descended_statistics_1d.attributes.min_value|int }}
        {%- else -%}null{%- endif -%}
    motion_person_floors_descended_max_1d:
      friendly_name: 'Floors down max (1d)'
      unit_of_measurement: 'â¬‡'
      icon_template: 'mdi:stairs-down'
      value_template: >-
        {% if states('sensor.motion_person_floors_descended_statistics_1d') != 'unknown' %}
          {{ states.sensor.motion_person_floors_descended_statistics_1d.attributes.max_value|int }}
        {%- else -%}null{%- endif -%}
    motion_person_floors_descended_stdev_1d:
      friendly_name: 'Floors down stdev (1d)'
      unit_of_measurement: 'â¬‡'
      icon_template: 'mdi:sigma-lower'
      value_template: >
        {% if states('sensor.motion_person_floors_descended_statistics_1d') != 'unknown' %}
          {{ states.sensor.motion_person_floors_descended_statistics_1d.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_person_floors_descended_change_1d:
      friendly_name: 'Floors down change (1d)'
      unit_of_measurement: 'â¬‡'
      icon_template: 'mdi:stairs-down'
      value_template: >
        {% if states('sensor.motion_person_floors_descended_statistics_1d') != 'unknown' %}
          {{ states.sensor.motion_person_floors_descended_statistics_1d.attributes.change|float }}
        {%- else -%}null{%- endif -%}

###
## 1w
###

# steps statistics

- platform: statistics
  name: motion_person_steps_statistics_1w
  entity_id: sensor.motion_person_steps
  sampling_size: 500
  max_age:
    hours: 168

- platform: template
  sensors:
    motion_person_steps_mean_1w:
      friendly_name: 'Steps Î¼ (1w)'
      unit_of_measurement: 'ğŸ¦¶'
      icon_template: 'mdi:walk'
      value_template: >-
        {% if states('sensor.motion_person_steps_statistics_1w') != 'unknown' %}
          {{ states.sensor.motion_person_steps_statistics_1w.state|float }}
        {%- else -%}null{%- endif -%}
    motion_person_steps_min_1w:
      friendly_name: 'Steps min (1w)'
      unit_of_measurement: 'ğŸ¦¶'
      icon_template: 'mdi:walk'
      value_template: >-
        {% if states('sensor.motion_person_steps_statistics_1w') != 'unknown' %}
          {{ states.sensor.motion_person_steps_statistics_1w.attributes.min_value|int }}
        {%- else -%}null{%- endif -%}
    motion_person_steps_max_1w:
      friendly_name: 'Steps max (1w)'
      unit_of_measurement: 'ğŸ¦¶'
      icon_template: 'mdi:walk'
      value_template: >-
        {% if states('sensor.motion_person_steps_statistics_1w') != 'unknown' %}
          {{ states.sensor.motion_person_steps_statistics_1w.attributes.max_value|int }}
        {%- else -%}null{%- endif -%}
    motion_person_steps_stdev_1w:
      friendly_name: Person steps stdev (1w)
      unit_of_measurement: 'ğŸ¦¶'
      icon_template: 'mdi:sigma-lower'
      value_template: >
        {% if states('sensor.motion_person_steps_statistics_1w') != 'unknown' %}
          {{ states.sensor.motion_person_steps_statistics_1w.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_person_steps_change_1w:
      friendly_name: Person steps change (1w)
      unit_of_measurement: 'ğŸ¦¶'
      icon_template: 'mdi:walk'
      value_template: >
        {% if states('sensor.motion_person_steps_statistics_1w') != 'unknown' %}
          {{ states.sensor.motion_person_steps_statistics_1w.attributes.change|float }}
        {%- else -%}null{%- endif -%}

# floors_ascended statistics

- platform: statistics
  name: motion_person_floors_ascended_statistics_1w
  entity_id: sensor.motion_person_floors_ascended
  sampling_size: 500
  max_age:
    hours: 168

- platform: template
  sensors:
    motion_person_floors_ascended_mean_1w:
      friendly_name: 'Floors up Î¼ (1w)'
      unit_of_measurement: 'â¬†'
      icon_template: 'mdi:stairs-up'
      value_template: >-
        {% if states('sensor.motion_person_floors_ascended_statistics_1w') != 'unknown' %}
          {{ states.sensor.motion_person_floors_ascended_statistics_1w.state|float }}
        {%- else -%}null{%- endif -%}
    motion_person_floors_ascended_min_1w:
      friendly_name: 'Floors up min (1w)'
      unit_of_measurement: 'â¬†'
      icon_template: 'mdi:stairs-up'
      value_template: >-
        {% if states('sensor.motion_person_floors_ascended_statistics_1w') != 'unknown' %}
          {{ states.sensor.motion_person_floors_ascended_statistics_1w.attributes.min_value|int }}
        {%- else -%}null{%- endif -%}
    motion_person_floors_ascended_max_1w:
      friendly_name: 'Floors up max (1w)'
      unit_of_measurement: 'â¬†'
      icon_template: 'mdi:stairs-up'
      value_template: >-
        {% if states('sensor.motion_person_floors_ascended_statistics_1w') != 'unknown' %}
          {{ states.sensor.motion_person_floors_ascended_statistics_1w.attributes.max_value|int }}
        {%- else -%}null{%- endif -%}
    motion_person_floors_ascended_stdev_1w:
      friendly_name: 'Floors up stdev (1w)'
      unit_of_measurement: 'â¬†'
      icon_template: 'mdi:sigma-lower'
      value_template: >
        {% if states('sensor.motion_person_floors_ascended_statistics_1w') != 'unknown' %}
          {{ states.sensor.motion_person_floors_ascended_statistics_1w.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_person_floors_ascended_change_1w:
      friendly_name: 'Floors up change (1w)'
      unit_of_measurement: 'â¬†'
      icon_template: 'mdi:stairs-up'
      value_template: >
        {% if states('sensor.motion_person_floors_ascended_statistics_1w') != 'unknown' %}
          {{ states.sensor.motion_person_floors_ascended_statistics_1w.attributes.change|float }}
        {%- else -%}null{%- endif -%}

# floors_descended statistics

- platform: statistics
  name: motion_person_floors_descended_statistics_1w
  entity_id: sensor.motion_person_floors_descended
  sampling_size: 500
  max_age:
    hours: 168

- platform: template
  sensors:
    motion_person_floors_descended_mean_1w:
      friendly_name: 'Floors down Î¼ (1w)'
      unit_of_measurement: 'â¬‡'
      icon_template: 'mdi:stairs-down'
      value_template: >-
        {% if states('sensor.motion_person_floors_descended_statistics_1w') != 'unknown' %}
          {{ states.sensor.motion_person_floors_descended_statistics_1w.state|float }}
        {%- else -%}null{%- endif -%}
    motion_person_floors_descended_min_1w:
      friendly_name: 'Floors down min (1w)'
      unit_of_measurement: 'â¬‡'
      icon_template: 'mdi:stairs-down'
      value_template: >-
        {% if states('sensor.motion_person_floors_descended_statistics_1w') != 'unknown' %}
          {{ states.sensor.motion_person_floors_descended_statistics_1w.attributes.min_value|int }}
        {%- else -%}null{%- endif -%}
    motion_person_floors_descended_max_1w:
      friendly_name: 'Floors down max (1w)'
      unit_of_measurement: 'â¬‡'
      icon_template: 'mdi:stairs-down'
      value_template: >-
        {% if states('sensor.motion_person_floors_descended_statistics_1w') != 'unknown' %}
          {{ states.sensor.motion_person_floors_descended_statistics_1w.attributes.max_value|int }}
        {%- else -%}null{%- endif -%}
    motion_person_floors_descended_stdev_1w:
      friendly_name: 'Floors down stdev (1w)'
      unit_of_measurement: 'â¬‡'
      icon_template: 'mdi:sigma-lower'
      value_template: >
        {% if states('sensor.motion_person_floors_descended_statistics_1w') != 'unknown' %}
          {{ states.sensor.motion_person_floors_descended_statistics_1w.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_person_floors_descended_change_1w:
      friendly_name: 'Floors down change (1w)'
      unit_of_measurement: 'â¬‡'
      icon_template: 'mdi:stairs-down'
      value_template: >
        {% if states('sensor.motion_person_floors_descended_statistics_1w') != 'unknown' %}
          {{ states.sensor.motion_person_floors_descended_statistics_1w.attributes.change|float }}
        {%- else -%}null{%- endif -%}

###
## 1m
###

# steps statistics

- platform: statistics
  name: motion_person_steps_statistics_1m
  entity_id: sensor.motion_person_steps
  sampling_size: 1000
  max_age:
    hours: 672

- platform: template
  sensors:
    motion_person_steps_mean_1m:
      friendly_name: 'Steps Î¼ (1m)'
      unit_of_measurement: 'ğŸ¦¶'
      icon_template: 'mdi:walk'
      value_template: >-
        {% if states('sensor.motion_person_steps_statistics_1m') != 'unknown' %}
          {{ states.sensor.motion_person_steps_statistics_1m.state|float }}
        {%- else -%}null{%- endif -%}
    motion_person_steps_min_1m:
      friendly_name: 'Steps min (1m)'
      unit_of_measurement: 'ğŸ¦¶'
      icon_template: 'mdi:walk'
      value_template: >-
        {% if states('sensor.motion_person_steps_statistics_1m') != 'unknown' %}
          {{ states.sensor.motion_person_steps_statistics_1m.attributes.min_value|int }}
        {%- else -%}null{%- endif -%}
    motion_person_steps_max_1m:
      friendly_name: 'Steps max (1m)'
      unit_of_measurement: 'ğŸ¦¶'
      icon_template: 'mdi:walk'
      value_template: >-
        {% if states('sensor.motion_person_steps_statistics_1m') != 'unknown' %}
          {{ states.sensor.motion_person_steps_statistics_1m.attributes.max_value|int }}
        {%- else -%}null{%- endif -%}
    motion_person_steps_stdev_1m:
      friendly_name: Person steps stdev (1m)
      unit_of_measurement: 'ğŸ¦¶'
      icon_template: 'mdi:sigma-lower'
      value_template: >
        {% if states('sensor.motion_person_steps_statistics_1m') != 'unknown' %}
          {{ states.sensor.motion_person_steps_statistics_1m.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_person_steps_change_1m:
      friendly_name: Person steps change (1m)
      unit_of_measurement: 'ğŸ¦¶'
      icon_template: 'mdi:walk'
      value_template: >
        {% if states('sensor.motion_person_steps_statistics_1m') != 'unknown' %}
          {{ states.sensor.motion_person_steps_statistics_1m.attributes.change|float }}
        {%- else -%}null{%- endif -%}

# floors_ascended statistics

- platform: statistics
  name: motion_person_floors_ascended_statistics_1m
  entity_id: sensor.motion_person_floors_ascended
  sampling_size: 1000
  max_age:
    hours: 672

- platform: template
  sensors:
    motion_person_floors_ascended_mean_1m:
      friendly_name: 'Floors up Î¼ (1m)'
      unit_of_measurement: 'â¬†'
      icon_template: 'mdi:stairs-down'
      value_template: >-
        {% if states('sensor.motion_person_floors_ascended_statistics_1m') != 'unknown' %}
          {{ states.sensor.motion_person_floors_ascended_statistics_1m.state|float }}
        {%- else -%}null{%- endif -%}
    motion_person_floors_ascended_min_1m:
      friendly_name: 'Floors up min (1m)'
      unit_of_measurement: 'â¬†'
      icon_template: 'mdi:stairs-down'
      value_template: >-
        {% if states('sensor.motion_person_floors_ascended_statistics_1m') != 'unknown' %}
          {{ states.sensor.motion_person_floors_ascended_statistics_1m.attributes.min_value|int }}
        {%- else -%}null{%- endif -%}
    motion_person_floors_ascended_max_1m:
      friendly_name: 'Floors up max (1m)'
      unit_of_measurement: 'â¬†'
      icon_template: 'mdi:stairs-down'
      value_template: >-
        {% if states('sensor.motion_person_floors_ascended_statistics_1m') != 'unknown' %}
          {{ states.sensor.motion_person_floors_ascended_statistics_1m.attributes.max_value|int }}
        {%- else -%}null{%- endif -%}
    motion_person_floors_ascended_stdev_1m:
      friendly_name: 'Floors up stdev (1m)'
      unit_of_measurement: 'â¬†'
      icon_template: 'mdi:sigma-lower'
      value_template: >
        {% if states('sensor.motion_person_floors_ascended_statistics_1m') != 'unknown' %}
          {{ states.sensor.motion_person_floors_ascended_statistics_1m.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_person_floors_ascended_change_1m:
      friendly_name: 'Floors up change (1m)'
      unit_of_measurement: 'â¬†'
      icon_template: 'mdi:stairs-down'
      value_template: >
        {% if states('sensor.motion_person_floors_ascended_statistics_1m') != 'unknown' %}
          {{ states.sensor.motion_person_floors_ascended_statistics_1m.attributes.change|float }}
        {%- else -%}null{%- endif -%}

# floors_descended statistics

- platform: statistics
  name: motion_person_floors_descended_statistics_1m
  entity_id: sensor.motion_person_floors_descended
  sampling_size: 1000
  max_age:
    hours: 672

- platform: template
  sensors:
    motion_person_floors_descended_mean_1m:
      friendly_name: 'Floors down Î¼ (1m)'
      unit_of_measurement: 'â¬‡'
      icon_template: 'mdi:stairs-down'
      value_template: >-
        {% if states('sensor.motion_person_floors_descended_statistics_1m') != 'unknown' %}
          {{ states.sensor.motion_person_floors_descended_statistics_1m.state|float }}
        {%- else -%}null{%- endif -%}
    motion_person_floors_descended_min_1m:
      friendly_name: 'Floors down min (1m)'
      unit_of_measurement: 'â¬‡'
      icon_template: 'mdi:stairs-down'
      value_template: >-
        {% if states('sensor.motion_person_floors_descended_statistics_1m') != 'unknown' %}
          {{ states.sensor.motion_person_floors_descended_statistics_1m.attributes.min_value|int }}
        {%- else -%}null{%- endif -%}
    motion_person_floors_descended_max_1m:
      friendly_name: 'Floors down max (1m)'
      unit_of_measurement: 'â¬‡'
      icon_template: 'mdi:stairs-down'
      value_template: >-
        {% if states('sensor.motion_person_floors_descended_statistics_1m') != 'unknown' %}
          {{ states.sensor.motion_person_floors_descended_statistics_1m.attributes.max_value|int }}
        {%- else -%}null{%- endif -%}
    motion_person_floors_descended_stdev_1m:
      friendly_name: 'Floors down stdev (1m)'
      unit_of_measurement: 'â¬‡'
      icon_template: 'mdi:sigma-lower'
      value_template: >
        {% if states('sensor.motion_person_floors_descended_statistics_1m') != 'unknown' %}
          {{ states.sensor.motion_person_floors_descended_statistics_1m.attributes.standard_deviation|float }}
        {%- else -%}null{%- endif -%}
    motion_person_floors_descended_change_1m:
      friendly_name: 'Floors down change (1m)'
      unit_of_measurement: 'â¬‡'
      icon_template: 'mdi:stairs-down'
      value_template: >
        {% if states('sensor.motion_person_floors_descended_statistics_1m') != 'unknown' %}
          {{ states.sensor.motion_person_floors_descended_statistics_1m.attributes.change|float }}
        {%- else -%}null{%- endif -%}
