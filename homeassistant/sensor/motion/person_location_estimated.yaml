## location estimated

- platform: template
  sensors:
    motion_person_location_estimated:
      unique_id: motion_person_location_estimated
      friendly_name: 'ðŸ‘± estimated (ðŸ§ž)'
      unit_of_measurement: 'ðŸ§ž'
      icon_template: >-
        {{- 'mdi:map-marker-circle' -}}
      attribute_templates:
        id: >-
          {{ state_attr('person.' + states('sensor.motion_person')|string,'id')|string + '_estimated' }}
        radius: 3
        gps_accuracy: 3
        entity_picture: >-
          {{- '/local/images/genie.png' -}}
      value_template: >-
        {{- 'Pending' -}}
    motion_person_location_estimated_source:
      unique_id: motion_person_location_estimated_source
      friendly_name: 'ðŸ‘± estimated source (ðŸŽ¯)'
      icon_template: >-
        {{- 'mdi:crosshairs' -}}
      value_template: >-
        {%- set s = state_attr('sensor.motion_person_location_estimated','source') -%}
        {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' -%}
          {{- s -}}
        {%- else -%}
          {%- set s = states('sensor.motion_person_location_estimated_source') -%}
          {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' -%}
            {{- s -}}
          {%- else -%}Pending{%- endif -%}
        {%- endif -%}
    motion_person_location_estimated_distance:
      unique_id: motion_person_location_estimated_distance
      friendly_name: 'ðŸ‘± movement'
      unit_of_measurement: 'm'
      icon_template: >-
        {{- 'mdi:ruler-square-compass' -}}
      value_template: >-
        {% if is_state('binary_sensor.motion_detected_person','on') %}
          {% set s = distance('sensor.motion_person_location_estimated') %}
          {% if s|lower != 'none' and s|lower != 'null' and s|lower != 'unknown' and s|lower != 'unavailable' and s|int is number and s|int < 40075 %}
            {% set m = s|float * 1000.0 %}
          {% endif %}
        {% endif %}
        {% if m is defined and m is number %}
          {{ '%0.3f'|format(m) }}
        {% else %}null{% endif %}

- platform: statistics
  name: motion_person_location_estimated_distance_statistics_1d
  entity_id: sensor.motion_person_location_estimated_distance
  sampling_size: 1000
  max_age:
    hours: 24

- platform: statistics
  name: motion_person_location_estimated_distance_statistics_1w
  entity_id: sensor.motion_person_location_estimated_distance
  sampling_size: 5000
  max_age:
    hours: 168

- platform: template
  sensors:
    motion_person_location_estimated_distance_total_1d:
      friendly_name: 'ðŸ‘± movement Î£ (1d)'
      unit_of_measurement: 'm'
      icon_template: 'mdi:ruler-square-compass'
      value_template: >-
        {% if states('sensor.motion_person_location_estimated_distance_statistics_1d') != 'unknown' %}
          {{ state_attr('sensor.motion_person_location_estimated_distance_statistics_1d','total')|float }}
        {%- else -%}null{%- endif -%}
    motion_person_location_estimated_distance_mean_1d:
      friendly_name: 'ðŸ‘± movement Î¼ (1d)'
      unit_of_measurement: 'm'
      icon_template: 'mdi:ruler-square-compass'
      value_template: >-
        {% if states('sensor.motion_person_location_estimated_distance_statistics_1d') != 'unknown' %}
          {{ states.sensor.motion_person_location_estimated_distance_statistics_1d.state|float }}
        {%- else -%}null{%- endif -%}
    motion_person_location_estimated_distance_min_1d:
      friendly_name: 'ðŸ‘± movement min (1d)'
      unit_of_measurement: 'm'
      icon_template: 'mdi:ruler-square-compass'
      value_template: >-
        {% if states('sensor.motion_person_location_estimated_distance_statistics_1d') != 'unknown' %}
          {{ state_attr('sensor.motion_person_location_estimated_distance_statistics_1d','min_value')|int }}
        {%- else -%}null{%- endif -%}
    motion_person_location_estimated_distance_max_1d:
      friendly_name: 'ðŸ‘± movement max (1d)'
      unit_of_measurement: 'm'
      icon_template: 'mdi:ruler-square-compass'
      value_template: >-
        {% if states('sensor.motion_person_location_estimated_distance_statistics_1d') != 'unknown' %}
          {{ state_attr('sensor.motion_person_location_estimated_distance_statistics_1d','max_value')|int }}
        {%- else -%}null{%- endif -%}
    motion_person_location_estimated_distance_stdev_1d:
      friendly_name: ðŸ‘± movement Ïƒ (1d)
      unit_of_measurement: 'm'
      icon_template: 'mdi:sigma-lower'
      value_template: >
        {% if states('sensor.motion_person_location_estimated_distance_statistics_1d') != 'unknown' %}
          {{ state_attr('sensor.motion_person_location_estimated_distance_statistics_1d','standard_deviation')|float }}
        {%- else -%}null{%- endif -%}
    motion_person_location_estimated_distance_change_1d:
      friendly_name: ðŸ‘± movement Î” (1d)
      unit_of_measurement: 'm'
      icon_template: 'mdi:ruler-square-compass'
      value_template: >
        {% if states('sensor.motion_person_location_estimated_distance_statistics_1d') != 'unknown' %}
          {{ state_attr('sensor.motion_person_location_estimated_distance_statistics_1d','change')|float }}
        {%- else -%}null{%- endif -%}
    motion_person_location_estimated_distance_total_1w:
      friendly_name: 'ðŸ‘± movement Î£ (1w)'
      unit_of_measurement: 'm'
      icon_template: 'mdi:ruler-square-compass'
      value_template: >-
        {% if states('sensor.motion_person_location_estimated_distance_statistics_1w') != 'unknown' %}
          {{ state_attr('sensor.motion_person_location_estimated_distance_statistics_1w','total')|float }}
        {%- else -%}null{%- endif -%}
    motion_person_location_estimated_distance_mean_1w:
      friendly_name: 'ðŸ‘± movement Î¼ (1w)'
      unit_of_measurement: 'm'
      icon_template: 'mdi:ruler-square-compass'
      value_template: >-
        {% if states('sensor.motion_person_location_estimated_distance_statistics_1w') != 'unknown' %}
          {{ states.sensor.motion_person_location_estimated_distance_statistics_1w.state|float }}
        {%- else -%}null{%- endif -%}
    motion_person_location_estimated_distance_min_1w:
      friendly_name: 'ðŸ‘± movement min (1w)'
      unit_of_measurement: 'm'
      icon_template: 'mdi:ruler-square-compass'
      value_template: >-
        {% if states('sensor.motion_person_location_estimated_distance_statistics_1w') != 'unknown' %}
          {{ state_attr('sensor.motion_person_location_estimated_distance_statistics_1w','min_value')|int }}
        {%- else -%}null{%- endif -%}
    motion_person_location_estimated_distance_max_1w:
      friendly_name: 'ðŸ‘± movement max (1w)'
      unit_of_measurement: 'm'
      icon_template: 'mdi:ruler-square-compass'
      value_template: >-
        {% if states('sensor.motion_person_location_estimated_distance_statistics_1w') != 'unknown' %}
          {{ state_attr('sensor.motion_person_location_estimated_distance_statistics_1w','max_value')|int }}
        {%- else -%}null{%- endif -%}
    motion_person_location_estimated_distance_stdev_1w:
      friendly_name: ðŸ‘± movement Ïƒ (1w)
      unit_of_measurement: 'm'
      icon_template: 'mdi:sigma-lower'
      value_template: >
        {% if states('sensor.motion_person_location_estimated_distance_statistics_1w') != 'unknown' %}
          {{ state_attr('sensor.motion_person_location_estimated_distance_statistics_1w','standard_deviation')|float }}
        {%- else -%}null{%- endif -%}
    motion_person_location_estimated_distance_change_1w:
      friendly_name: ðŸ‘± movement Î” (1w)
      unit_of_measurement: 'm'
      icon_template: 'mdi:ruler-square-compass'
      value_template: >
        {% if states('sensor.motion_person_location_estimated_distance_statistics_1w') != 'unknown' %}
          {{ state_attr('sensor.motion_person_location_estimated_distance_statistics_1w','change')|float }}
        {%- else -%}null{%- endif -%}

- platform: statistics
  name: motion_person_location_estimated_distance_stdev_1d_statistics
  entity_id: sensor.motion_person_location_estimated_distance_stdev_1d
  sampling_size: 1000
  max_age:
    hours: 24

- platform: statistics
  name: motion_person_location_estimated_distance_stdev_1w_statistics
  entity_id: sensor.motion_person_location_estimated_distance_stdev_1w
  sampling_size: 1000
  max_age:
    hours: 24

