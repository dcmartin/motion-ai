###
## homeassistant/sensor/motion/person_location_estimated.yaml
###

## location estimated

- platform: template
  sensors:
    motion_person_location_estimated:
      unique_id: motion_person_location_estimated
      friendly_name: 'ðŸ‘± estimated (ðŸ§ž)'
      unit_of_measurement: 'ðŸ§ž'
      icon_template: >-
        {{- 'mdi:map-marker-circle' -}}
      attribute_templates:
        id: >-
          {{ state_attr('person.' + states('sensor.motion_person')|string,'id')|string + '_estimated' }}
        entity_picture: >-
          {{- '/local/images/genie.png' -}}
      value_template: >-
        {{- 'Pending' -}}
    motion_person_location_estimated_previous:
      unique_id: motion_person_location_estimated_previous
      friendly_name: 'ðŸ‘± estimated previous (ðŸ§ž)'
      attribute_templates:
        velocity: 0.0
        movement: >-
          {{ 'unknown' }}
        interval: >-
          {{ 'unknown' }}
        timestamp: >-
          {{ 'unknown' }}
        latitude: >-
          {{ 'unknown' }}
        longitude: >-
          {{ 'unknown' }}
        confidence: >-
          {{ 'unknown' }}
        distance: >-
          {{ 'unknown' }}
        source: >-
          {{ 'unknown' }}
        zone: >-
          {{ 'unknown' }}
      icon_template: >-
        {{- 'mdi:map-marker-circle' -}}
      value_template: >-
        {{ 'unknown' }}

## source for history and lovelace.json.tmpl

- platform: template
  sensors:
    motion_person_location_estimated_source:
      unique_id: motion_person_location_estimated_source
      friendly_name: 'ðŸ‘± estimated source (ðŸŽ¯)'
      icon_template: >-
        {{- 'mdi:crosshairs' -}}
      value_template: >-
        {%- set s = state_attr('sensor.motion_person_location_estimated','source') -%}
        {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' -%}
          {{- s -}}
        {%- else -%}
          {%- set s = states('sensor.motion_person_location_estimated_source') -%}
          {%- if s|lower != 'none' and s|lower != 'unknown' and s|lower != 'unavailable' and s|lower != 'null' -%}
            {{- s -}}
          {%- else -%}Pending{%- endif -%}
        {%- endif -%}

## movement statistics

- platform: statistics
  name: motion_person_location_estimated_movement_statistics_1h
  entity_id: sensor.motion_person_estimated_movement_measurement
  sampling_size: 30
  max_age:
    hours: 1

- platform: statistics
  name: motion_person_location_estimated_movement_statistics_2h
  entity_id: sensor.motion_person_estimated_movement_measurement
  sampling_size: 60
  max_age:
    hours: 2

- platform: statistics
  name: motion_person_location_estimated_movement_statistics_4h
  entity_id: sensor.motion_person_estimated_movement_measurement
  sampling_size: 120
  max_age:
    hours: 4

- platform: statistics
  name: motion_person_location_estimated_movement_statistics_8h
  entity_id: sensor.motion_person_estimated_movement_measurement
  sampling_size: 240
  max_age:
    hours: 8

- platform: statistics
  name: motion_person_location_estimated_movement_statistics_12h
  entity_id: sensor.motion_person_estimated_movement_measurement
  sampling_size: 360
  max_age:
    hours: 12 

- platform: statistics
  name: motion_person_location_estimated_movement_statistics_1d
  entity_id: sensor.motion_person_estimated_movement_measurement
  sampling_size: 720
  max_age:
    hours: 24

- platform: statistics
  name: motion_person_location_estimated_movement_statistics_1w
  entity_id: sensor.motion_person_estimated_movement_measurement
  sampling_size: 5040
  max_age:
    hours: 168

## movement secondary 
#
#- platform: template
#  sensors:
#    motion_person_location_estimated_movement_stdev_1d:
#      unit_of_measurement: m
#      value_template: >-
#        {{ state_attr('sensor.motion_person_location_estimated_movement_statistics_1d','standard_deviation')|float }}
#
#- platform: statistics
#  name: motion_person_location_estimated_movement_stdev_1d_statistics
#  entity_id: sensor.motion_person_location_estimated_movement_stdev_1d
#  sampling_size: 100
#  max_age:
#    hours: 24
#
#- platform: template
#  sensors:
#    motion_person_location_estimated_movement_stdev_1w:
#      unit_of_measurement: m
#      value_template: >-
#        {{ state_attr('sensor.motion_person_location_estimated_movement_statistics_1w','standard_deviation')|float }}
#
#- platform: statistics
#  name: motion_person_location_estimated_movement_stdev_1w_statistics
#  entity_id: sensor.motion_person_location_estimated_movement_stdev_1w
#  sampling_size: 1000
#  max_age:
#    hours: 168

## velocity statistics

- platform: statistics
  name: motion_person_location_estimated_velocity_statistics_1h
  entity_id: sensor.motion_person_estimated_velocity_measurement
  sampling_size: 30
  max_age:
    hours: 1

- platform: statistics
  name: motion_person_location_estimated_velocity_statistics_2h
  entity_id: sensor.motion_person_estimated_velocity_measurement
  sampling_size: 60
  max_age:
    hours: 2

- platform: statistics
  name: motion_person_location_estimated_velocity_statistics_4h
  entity_id: sensor.motion_person_estimated_velocity_measurement
  sampling_size: 120
  max_age:
    hours: 4

- platform: statistics
  name: motion_person_location_estimated_velocity_statistics_8h
  entity_id: sensor.motion_person_estimated_velocity_measurement
  sampling_size: 240
  max_age:
    hours: 8

- platform: statistics
  name: motion_person_location_estimated_velocity_statistics_12h
  entity_id: sensor.motion_person_estimated_velocity_measurement
  sampling_size: 360
  max_age:
    hours: 12 

- platform: statistics
  name: motion_person_location_estimated_velocity_statistics_1d
  entity_id: sensor.motion_person_estimated_velocity_measurement
  sampling_size: 720
  max_age:
    hours: 24

- platform: statistics
  name: motion_person_location_estimated_velocity_statistics_1w
  entity_id: sensor.motion_person_estimated_velocity_measurement
  sampling_size: 5040
  max_age:
    hours: 168

# velocity change

- platform: template
  sensors:
    motion_person_location_estimated_velocity_change_1h:
      unit_of_measurement: 'm/s'
      value_template: >-
        {{ state_attr('sensor.motion_person_location_estimated_velocity_statistics_1h','change')|float }}

- platform: statistics
  name: motion_person_location_estimated_velocity_change_1h_statistics
  entity_id: sensor.motion_person_location_estimated_velocity_change_1h
  sampling_size: 30
  max_age:
    hours: 1

- platform: template
  sensors:
    motion_person_location_estimated_velocity_change_2h:
      unit_of_measurement: 'm/s'
      value_template: >-
        {{ state_attr('sensor.motion_person_location_estimated_velocity_statistics_2h','change')|float }}

- platform: statistics
  name: motion_person_location_estimated_velocity_change_2h_statistics
  entity_id: sensor.motion_person_location_estimated_velocity_change_2h
  sampling_size: 60
  max_age:
    hours: 2

- platform: template
  sensors:
    motion_person_location_estimated_velocity_change_4h:
      unit_of_measurement: 'm/s'
      value_template: >-
        {{ state_attr('sensor.motion_person_location_estimated_velocity_statistics_4h','change')|float }}

- platform: statistics
  name: motion_person_location_estimated_velocity_change_4h_statistics
  entity_id: sensor.motion_person_location_estimated_velocity_change_4h
  sampling_size: 120
  max_age:
    hours: 4

- platform: template
  sensors:
    motion_person_location_estimated_velocity_change_8h:
      unit_of_measurement: 'm/s'
      value_template: >-
        {{ state_attr('sensor.motion_person_location_estimated_velocity_statistics_8h','change')|float }}

- platform: statistics
  name: motion_person_location_estimated_velocity_change_8h_statistics
  entity_id: sensor.motion_person_location_estimated_velocity_change_8h
  sampling_size: 240
  max_age:
    hours: 8

- platform: template
  sensors:
    motion_person_location_estimated_velocity_change_12h:
      unit_of_measurement: 'm/s'
      value_template: >-
        {{ state_attr('sensor.motion_person_location_estimated_velocity_statistics_12h','change')|float }}

- platform: statistics
  name: motion_person_location_estimated_velocity_change_12h_statistics
  entity_id: sensor.motion_person_location_estimated_velocity_change_12h
  sampling_size: 360
  max_age:
    hours: 12

- platform: template
  sensors:
    motion_person_location_estimated_velocity_change_1d:
      unit_of_measurement: 'm/s'
      value_template: >-
        {{ state_attr('sensor.motion_person_location_estimated_velocity_statistics_1d','change')|float }}

- platform: statistics
  name: motion_person_location_estimated_velocity_change_1d_statistics
  entity_id: sensor.motion_person_location_estimated_velocity_change_1d
  sampling_size: 720
  max_age:
    hours: 24

- platform: template
  sensors:
    motion_person_location_estimated_velocity_change_1w:
      unit_of_measurement: 'm/s'
      value_template: >-
        {{ state_attr('sensor.motion_person_location_estimated_velocity_statistics_1w','change')|float }}

- platform: statistics
  name: motion_person_location_estimated_velocity_change_1w_statistics
  entity_id: sensor.motion_person_location_estimated_velocity_change_1w
  sampling_size: 5040
  max_age:
    hours: 168

