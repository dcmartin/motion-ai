###
## homeassistant/sensor/motion/powerwall.yaml
###

# statistics

- platform: statistics
  name: motion_powerwall_load_now_statistics
  entity_id: sensor.motion_powerwall_load_now
  sampling_size: 1000
  max_age:
    days: 7

- platform: statistics
  name: motion_powerwall_site_now_statistics
  entity_id: sensor.motion_powerwall_site_now
  sampling_size: 1000
  max_age:
    days: 7

- platform: statistics
  name: motion_powerwall_solar_now_statistics
  entity_id: sensor.motion_powerwall_solar_now
  sampling_size: 1000
  max_age:
    days: 7

- platform: statistics
  name: motion_powerwall_battery_now_statistics
  entity_id: sensor.motion_powerwall_battery_now
  sampling_size: 1000
  max_age:
    days: 7

# history

- platform: history_stats
  name: motion_powerwall_load_spike_ratio_1d
  entity_id: binary_sensor.motion_powerwall_load_spike
  state: 'on'
  type: ratio
  start: '{{ now().replace(hour=0).replace(minute=0).replace(second=0) }}'
  end: '{{ now() }}'

- platform: history_stats
  name: motion_powerwall_load_spike_ratio_1w
  entity_id: binary_sensor.motion_powerwall_load_spike
  state: 'on'
  type: ratio
  start: >-
    {{ now().replace(hour=0).replace(minute=0).replace(second=0).timestamp()|int - states('sensor.motion_person_weeks_timestamp')|int }}
  end: '{{ now() }}'

- platform: history_stats
  name: motion_powerwall_load_spike_count_1d
  entity_id: binary_sensor.motion_powerwall_load_spike
  state: 'on'
  type: count
  start: '{{ now().replace(hour=0).replace(minute=0).replace(second=0) }}'
  end: '{{ now() }}'

- platform: history_stats
  name: motion_powerwall_load_spike_count_1w
  entity_id: binary_sensor.motion_powerwall_load_spike
  state: 'on'
  type: count
  start: >-
    {{ now().replace(hour=0).replace(minute=0).replace(second=0).timestamp()|int - states('sensor.motion_person_weeks_timestamp')|int }}
  end: '{{ now() }}'

- platform: history_stats
  name: motion_powerwall_load_spike_time_1d
  entity_id: binary_sensor.motion_powerwall_load_spike
  state: 'on'
  type: time
  start: '{{ now().replace(hour=0).replace(minute=0).replace(second=0) }}'
  end: '{{ now() }}'

- platform: history_stats
  name: motion_powerwall_load_spike_time_1w
  entity_id: binary_sensor.motion_powerwall_load_spike
  state: 'on'
  type: time
  start: >-
    {{ now().replace(hour=0).replace(minute=0).replace(second=0).timestamp()|int - states('sensor.motion_person_weeks_timestamp')|int }}
  end: '{{ now() }}'
