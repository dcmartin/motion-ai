###
## sensor/motion/person_activity_day.yaml
###

- platform: history_stats
  name: motion_person_active_count_day
  entity_id: binary_sensor.motion_person_active
  state: 'on'
  type: count
  start: >-
    {% set s = state_attr('sensor.motion_sun','day') %}
    {% if s|lower != 'none' and s|lower != 'null' and s|float(0.0) > 0 %}
      {{ s }}
    {% else %}
      {{ now().replace(hour=6).replace(minute=0).replace(second=0) }}
    {% endif %}
  end: >-
    {% set s = state_attr('sensor.motion_sun','night') %}
    {% if s|lower != 'none' and s|lower != 'null' and s|float(0.0) > 0 %}
      {{ s }}
    {% else %}
      {{ now().replace(hour=18).replace(minute=0).replace(second=0) }}
    {% endif %}

- platform: history_stats
  name: motion_person_active_time_day
  entity_id: binary_sensor.motion_person_active
  state: 'on'
  type: time
  start: >-
    {% set s = state_attr('sensor.motion_sun','day') %}
    {% if s|lower != 'none' and s|lower != 'null' and s|float(0.0) > 0 %}
      {{ s }}
    {% else %}
      {{ now().replace(hour=6).replace(minute=0).replace(second=0) }}
    {% endif %}
  end: >-
    {% set s = state_attr('sensor.motion_sun','night') %}
    {% if s|lower != 'none' and s|lower != 'null' and s|float(0.0) > 0 %}
      {{ s }}
    {% else %}
      {{ now().replace(hour=18).replace(minute=0).replace(second=0) }}
    {% endif %}
