###
# homeassistant/sensor/device/class/presence.yaml
###


#- platform: group
#  name: motion_device_presence_measurement_group
#  type: 'last'
#  ignore_non_numeric: 'false'
#  entities:
#    - sensor.motion_device_presence

- platform: template
  sensors:
    motion_device_presence_count:
      friendly_name: Count of presence sensors
      unit_of_measurement: 'count'
      attribute_templates:
        total: >-
          {{- None -}}
        dids: >-
          {{- [] -}}
        entitys: >-
          {{- [] -}}
      value_template: >-
        {#- set through automation -#}
        {{- 'none' -}}

- platform: template
  sensors:
    motion_device_presence_update:
      friendly_name: Frequency of presence updates
      unit_of_measurement: 'Hz'
      device_class: 'frequency'
      attribute_templates:
        entitys: >-
          {{- 'unknown' -}}
      value_template: >-
        {#- set through automation -#}

- platform: template
  sensors:
    motion_device_presence:
      friendly_name: Measurement presence
      unit_of_measurement: '†'
      attribute_templates:
        last: >-
          {{- 'none' -}}
        unit: >-
          {{- 'none' -}}
        ids: >-
          {{- 'none' -}}
        total: >-
          {{- 'none' -}}
        areas: >-
          {{- 'none' -}}
        values: >-
          {{- 'none' -}}
        min: >-
          {{- 'none' -}}
        max: >-
          {{- 'none' -}}
        mean: >-
          {{- 'none' -}}
        sum: >-
          {{- 'none' -}}
        count: >-
          {{- 'none' -}}
        measurement: >-
          {{- 'none' -}}
        statistics: >-
          {{- 'none' -}}
      value_template: >-
        {#- set through automation -#}
        {{- 'none' -}}

# max

- platform: template
  sensors:
    motion_device_presence_max:
      friendly_name: Maximum presence
      unit_of_measurement: '†'
      attribute_templates:
        spike: >-
          {{ states('binary_sensor.motion_device_presence_high_spike') }}
        min: >-
         {{ states('sensor.motion_device_presence_max_1w_min') }}
        max: >-
         {{ states('sensor.motion_device_presence_max_1w_max') }}
        mean: >-
         {{ states('sensor.motion_device_presence_max_1w_mean') }}
        stdev: >-
         {{ states('sensor.motion_device_presence_max_1w_stdev') }}
        coverage: >-
         {{ state_attr('sensor.motion_device_presence_max_1w_max','age_coverage_ratio')|float(0) * 100 }}
        usage: >-
         {{ state_attr('sensor.motion_device_presence_max_1w_max','buffer_usage_ratio')|float(0) * 100 }}
      value_template: >-
        {{ state_attr('sensor.motion_device_presence','max')|float(none) }}
    motion_device_presence_1w_max:
      friendly_name: 'Maximum presence (1w)'
      value_template: >-
        {{ state_attr('sensor.motion_device_presence_max','max')|float(none) }}

# min

- platform: template
  sensors:
    motion_device_presence_min:
      friendly_name: Minimum presence
      unit_of_measurement: '†'
      attribute_templates:
        spike: >-
          {{ states('binary_sensor.motion_device_presence_low_spike') }}
        min: >-
         {{ states('sensor.motion_device_presence_min_1w_min') }}
        max: >-
         {{ states('sensor.motion_device_presence_min_1w_max') }}
        mean: >-
         {{ states('sensor.motion_device_presence_min_1w_mean') }}
        stdev: >-
         {{ states('sensor.motion_device_presence_min_1w_stdev') }}
        coverage: >-
         {{ state_attr('sensor.motion_device_presence_min_1w_max','age_coverage_ratio')|float(0) * 100 }}
        usage: >-
         {{ state_attr('sensor.motion_device_presence_min_1w_max','buffer_usage_ratio')|float(0) * 100 }}
      value_template: >-
        {{ state_attr('sensor.motion_device_presence','max')|float(none) }}
    motion_device_presence_1w_min:
      friendly_name: 'Minimum presence (1w)'
      value_template: >-
        {{ state_attr('sensor.motion_device_presence_max','max')|float(none) }}

- platform: statistics
  name: motion_device_presence_max_1w_mean
  entity_id: sensor.motion_device_presence_max
  state_characteristic: mean
  sampling_size: 1000
  max_age:
    days: 7

- platform: statistics
  name: motion_device_presence_max_1w_stdev
  entity_id: sensor.motion_device_presence_max
  state_characteristic: standard_deviation
  sampling_size: 1000
  max_age:
    days: 7

- platform: statistics
  name: motion_device_presence_max_1w_stdev_mean
  entity_id: sensor.motion_device_presence_1w_stdev
  state_characteristic: mean
  sampling_size: 1000
  max_age:
    days: 7

- platform: statistics
  name: motion_device_presence_max_1w_min
  entity_id: sensor.motion_device_presence_max
  state_characteristic: value_min
  sampling_size: 1000
  max_age:
    days: 7

- platform: statistics
  name: motion_device_presence_max_1w_max
  entity_id: sensor.motion_device_presence_max
  state_characteristic: value_max
  sampling_size: 1000
  max_age:
    days: 7

- platform: statistics
  name: motion_device_presence_min_1w_mean
  entity_id: sensor.motion_device_presence_max
  state_characteristic: mean
  sampling_size: 1000
  max_age:
    days: 7

- platform: statistics
  name: motion_device_presence_min_1w_stdev
  entity_id: sensor.motion_device_presence_max
  state_characteristic: standard_deviation
  sampling_size: 1000
  max_age:
    days: 7

- platform: statistics
  name: motion_device_presence_min_1w_stdev_mean
  entity_id: sensor.motion_device_presence_1w_stdev
  state_characteristic: mean
  sampling_size: 1000
  max_age:
    days: 7

- platform: statistics
  name: motion_device_presence_min_1w_min
  entity_id: sensor.motion_device_presence_max
  state_characteristic: value_min
  sampling_size: 1000
  max_age:
    days: 7

- platform: statistics
  name: motion_device_presence_min_1w_max
  entity_id: sensor.motion_device_presence_max
  state_characteristic: value_max
  sampling_size: 1000
  max_age:
    days: 7
