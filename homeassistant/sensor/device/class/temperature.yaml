###
# homeassistant/sensor/device/temperature.yaml
###

- platform: template
  sensors:
    motion_device_temperature:
      friendly_name: Measurement temperature
      device_class: 'temperature'
      unit_of_measurement: 'Â°'
      attribute_templates:
        ids: >-
          {{- state_attr('binary_sensor.motion_device_temperature','ids') -}}
        total: >-
          {{- state_attr('binary_sensor.motion_device_temperature','total') -}}
        measurement: >-
          {{- state_attr('binary_sensor.motion_device_temperature','status') -}}
        areas: >-
          {{- state_attr('binary_sensor.motion_device_temperature','areas') -}}
        values: >-
          {{- state_attr('binary_sensor.motion_device_temperature','values') -}}
        min: >-
          {% set s = state_attr('binary_sensor.motion_device_temperature','values') -%}
          {% if s|lower != 'none' and not s is string %}
            {% set s = s|select('number')|list|default(none) %}
            {% if s|lower != 'none' and s|count > 0 %}
              {{ s|min }}
            {% else %}none{% endif %}
          {% else %}none{% endif %}
        max: >-
          {% set s = state_attr('binary_sensor.motion_device_temperature','values') -%}
          {% if s|lower != 'none' and not s is string %}
            {% set s = s|select('number')|list|default(none) %}
            {% if s|lower != 'none' and s|count > 0 %}
              {{ s|max }}
            {% else %}none{% endif %}
          {% else %}none{% endif %}
        mean: >-
          {% set s = state_attr('binary_sensor.motion_device_temperature','values') -%}
          {% if s|lower != 'unknown' and s|lower != 'none' and s|lower != 'unavailable' and s|lower != 'none' %}
            {% set s = s|select('number')|list|default(none) %}
            {% if s|lower != 'none' and s|count > 0 %}
              {{ '%0.2f'|format(s|average) }}
            {% else %}none{% endif %}
          {% else %}none{% endif %}
        sum: >-
          {% set s = state_attr('binary_sensor.motion_device_temperature','values') -%}
          {% if s|lower != 'unknown' and s|lower != 'none' and s|lower != 'unavailable' and s|lower != 'none' %}
            {% set s = s|select('number')|list|default(none) %}
            {% if s|lower != 'none' and s|count > 0 %}
              {{ '%0.2f'|format(s|sum) }}
            {% else %}none{% endif %}
          {% else %}none{% endif %}
        count: >-
          {% set s = state_attr('binary_sensor.motion_device_temperature','values') -%}
          {% if s|lower != 'unknown' and s|lower != 'none' and s|lower != 'unavailable' and s|lower != 'none' %}
            {% set s = s|select('number')|list|default(none) %}
            {% if s|lower != 'none' and s|count > 0 %}
              {{ (s|count) }}
            {% else %}none{% endif %}
          {% else %}none{% endif %}
      value_template: >-
        {{- state_attr('sensor.motion_device_temperature','count') -}}
