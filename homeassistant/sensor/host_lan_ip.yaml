###
## homeassistant/sensor/host_lan_ip.yaml
###

#- platform: command_line
#  command: echo '{"date":'$(date "+%s")',"hostname":"'$(hostname)'","ipv4":"'$(ip addr | egrep "global" | sed "s/.* \([0-9\.]*\)\/.*/\1/" | head -1)'"}'
#  name: host_lan_ip
#  scan_interval: 14400
#  command_timeout: 30
#  json_attributes:
#    - date
#    - hostname
#    - ipv4
#  value_template: >
#    {%- if value_json is defined -%}
#      {{ value_json.date | int | timestamp_custom("%a %b %d @ %I:%M %p %Z",true,'unknown') }}
#    {%- else -%}{{- 'none' -}}{%- endif -%}

- platform: template
  sensors:
    host_lan_ipv4:
      friendly_name: Host IP
      icon_template: 'mdi:network'
      value_template: >-
        {{- state_attr('sensor.intranet_test','client') -}}
    host_lan_ago:
      friendly_name: Host LAN ago
      unit_of_measurement: s
      icon_template: 'mdi:av-timer'
      value_template: >-
        {{- utcnow().timestamp()|int(0) - state_attr('sensor.host_lan_ip','date')|int(0) -}}
