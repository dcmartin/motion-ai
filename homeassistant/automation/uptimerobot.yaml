###
# automation/uptimerobot.yaml
###

- id: uptime_robot_feed
  alias: uptime_robot_feed
  initial_state: on
  trigger:
    - platform: state
      entity_id: sensor.internet_test
      to: 'True'
    - platform: state
      entity_id: binary_sensor.remote_ui
      to: 'on'
    - platform: state
      entity_id: binary_sensor.uptimerobot_feed
      attribute: 'rssurl'
  condition:
    condition: and
    conditions:
      - condition: template
        value_template: >
          {% set s = state_attr('binary_sensor.uptimerobot_feed','rssurl') %}
          {{ s|lower != 'none' and s|lower != 'unavailable' and s|lower != 'unknown' and s|lower != 'null' }}
  action:
    - service: homeassistant.update_entity
      entity_id: sensor.uptimerobot_feed
